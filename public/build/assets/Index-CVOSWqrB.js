import{y as H,W as re,r as u,q as se,j as e,Y as oe,a as le}from"./app-UVFO0ZgA.js";import{B as te}from"./Breadcrumbs-Cpuw1mof.js";import{C as ie,a as de,F as ce,D as ee,T as he}from"./GlobalHooks-CRJfo_kG.js";import{F as w}from"./FormSelectPrefix-BDIlTEfx.js";import{I as f}from"./Icon-CIUb5iLn.js";import{L as ae}from"./Label-5h4Oivxf.js";import{N as me}from"./NameWithAvatar--bwZYf6g.js";import{A as G}from"./ActionButton-C8zkDC9Q.js";import{U as pe,T as n}from"./UsePageController-D4e6JcyB.js";import{B as F}from"./react-toastify.esm-BG4VbzAR.js";import{A as xe}from"./AppContentLayout-uprGBnmC.js";import{C as D}from"./ContentWrapper-BG-1JI41.js";import{f as C,g as ue,l as ge,a as je,b as fe,m as be,h as ve}from"./GlobalFunction-ClZYWXXL.js";import we from"./PerencanaanCreate-CqGF2Spz.js";import De from"./PerencanaanDetail-BCEk0rRC.js";import Ce from"./PerencanaanConfirm-DJQwfI6P.js";import Se from"./PerencanaanGenerate-Cpk5kw7n.js";import"./Button-F8vdd4UU.js";import"./clsx-B-dksMZM.js";import"./FormInput-CBwyJR2b.js";import"./RegularSubmitModal-C1sT-BSU.js";/* empty css                      */import"./transition-Dt1y6Vjt.js";import"./FormTextarea-CEIdF7dn.js";import"./Modal-Cr2HN_1p.js";import"./dialog-B54NAuet.js";const Me=(o,d,l)=>{H.post(route("perencanaan.store"),o,{onError:i=>{d(i)},onSuccess:()=>{l()},preserveScroll:!1,preserveState:!0})},Ne=(o,d,l)=>{H.post(route("perencanaan.update",{perencanaan:o.id}),{...o,_method:"PUT"},{onError:i=>{d(i)},onSuccess:()=>{l()},preserveScroll:!1,preserveState:!0})},Te=(o,d,l)=>{H.post(route("perencanaan.confirm",{perencanaan:o.id}),{...o,_method:"PUT"},{onError:i=>{d(i)},onSuccess:()=>{l()},preserveScroll:!1,preserveState:!0})},ye=(o,d,l)=>{H.post(route("perencanaan.generate"),o,{onError:i=>{d(i)},onSuccess:()=>{l()},preserveScroll:!1,preserveState:!0})},ke=(o,d)=>{const{data:l,setData:i,reset:g}=re({kategori_id:"",pic_id:"",judul:"",nominal:"",bulan:"",tahun:"",tipe:"cash",deskripsi:""}),[p,s]=u.useState({}),[S,h]=u.useState(null),x=()=>{s({})},{mode:b,params:v,setParams:U,fetching:j,request:m,showModal:z,handleShowModal:I,handleEditModal:L,handleCloseModal:M,initialData:t,setInitialData:c,setFetching:R,onHandleFilter:W,onHandleOrder:K}=pe(o,x,g,"perencanaan.index");u.useEffect(()=>{j&&m(v)},[v,j]),u.useEffect(()=>{t.id&&i({id:t.id,kategori_id:t.kategori_id,pic_id:t.pic_id,judul:t.judul,nominal:t.nominal,bulan:t.bulan,tahun:t.tahun,tipe:t.tipe,deskripsi:t.deskripsi})},[t]);const N=r=>{i(r.target.name,r.target.type==="file"?r.target.files[0]:r.target.value)},Y=r=>{r.target.checked?i(r.target.name,1):i(r.target.name,0)},q=r=>{r.preventDefault(),h(F.loading("Sedang menyimpan data...")),Me(l,s,x)},O=r=>{r.preventDefault(),h(F.loading("Sedang menyimpan data...")),Ne(l,s,x)},[J,T]=u.useState({}),[$,y]=u.useState(!1),Q=r=>{y(!0),T(r)},V=r=>{y(!1),c({}),g()},[k,B]=u.useState(!1),X=r=>{B(!0),T(r),c(r)},_=r=>{B(!1),c({}),g()},[E,P]=u.useState(!1),a=()=>{P(!0),i({...l,bulan:o.bulan,tahun:o.tahun})},A=()=>{P(!1),g()},Z=r=>{r.preventDefault(),h(F.loading("Sedang generate data...")),ye(l,s,x)},ne=r=>{r.preventDefault(),h(F.loading("Sedang memproses data...")),Te(l,s,x)};return ie(d,p,S,h,k?_:E?A:M),{data:l,processing:S,errors:p,submit:q,update:O,handleChange:N,handleCheckboxChange:Y,mode:b,params:v,setParams:U,setFetching:R,onHandleFilter:W,onHandleOrder:K,showModal:z,handleShowModal:I,handleEditModal:L,handleCloseModal:M,detailData:J,showDetailModal:$,handleShowDetailModal:Q,handleCloseDetailModal:V,showConfirmModal:k,handleShowConfirmModal:X,handleCloseConfirmModal:_,confirm:ne,showGenerateModal:E,handleShowGenerateModal:a,handleCloseGenerateModal:A,generate:Z}},na=({title:o,breadcrumbs:d,datas:l,categories:i,users:g,widget:p,filtered:s,flash:S})=>{const{data:h,processing:x,errors:b,submit:v,update:U,handleChange:j,params:m,setParams:z,setFetching:I,mode:L,showModal:M,onHandleFilter:t,onHandleOrder:c,handleShowModal:R,handleEditModal:W,handleCloseModal:K,detailData:N,showDetailModal:Y,handleShowDetailModal:q,handleCloseDetailModal:O,showConfirmModal:J,handleShowConfirmModal:T,handleCloseConfirmModal:$,confirm:y,showGenerateModal:Q,handleShowGenerateModal:V,handleCloseGenerateModal:k,generate:B}=ke(s,S),{auth:X}=se().props,_=[{value:"waiting",label:"Waiting"},{value:1,label:"Accept"},{value:0,label:"Reject"}],E=()=>l.data.some(a=>a.status!=1),P=()=>l.data.length>0?l.data.map((a,A)=>e.jsxs(n.TrBody,{children:[e.jsx(n.Td,{children:A+1}),e.jsx(n.Td,{children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(me,{avatar:a.pic.foto?`/images/${a.pic.foto}`:a.pic.foto,name:a.pic.name})})}),e.jsx(n.Td,{children:a.kategori.nama}),e.jsx(n.Td,{children:a.judul}),e.jsx(n.Td,{children:C(a.nominal)}),e.jsx(n.Td,{children:be(a.bulan)}),e.jsx(n.Td,{children:a.tahun}),e.jsx(n.Td,{children:e.jsx(ae,{variant:a.tipe=="cash"?"info":"success",children:a.tipe})}),e.jsx(n.Td,{children:e.jsx(ae,{variant:a.status==0?"danger":a.status==1?"success":"warning",children:a.status==0?"reject":a.status==1?"accept":"waiting"})}),e.jsxs(n.Td,{className:"text-end pe-3",children:[X.user.roles.find(Z=>Z.name==="Admin")&&a.status==null?e.jsx(G,{variant:"success",icon:"check-lg",label:"Konfirmasi",onClick:()=>T(a)}):e.jsx(G,{variant:"warning",icon:"search",label:"Detail",onClick:()=>q(a)}),e.jsx(G,{variant:"info",icon:"pencil",label:"Edit",onClick:()=>W(a)}),e.jsx(G,{variant:"danger",icon:"trash",label:"Hapus",onClick:()=>ve("perencanaan.destroy",a.id,"Data berhasil dihapus")})]})]},a.id)):e.jsx(he,{colSpan:10});return e.jsxs(xe,{children:[e.jsx(oe,{title:o}),e.jsx(te,{title:o,breadcrumbs:d}),e.jsxs("div",{className:"grid grid-cols-4 gap-5 mb-5",children:[e.jsx("div",{className:"col-span-2 lg:col-span-1",children:e.jsxs(D,{className:"flex flex-col gap-2 pb-6 text-danger border border-2 border-danger",children:[e.jsx("span",{className:"text-md lg:text-xl font-semibold",children:"Limit Anggaran"}),e.jsx("span",{className:"text-2xl lg:text-4xl font-bold",children:C(p.limit_anggaran)})]})}),e.jsx("div",{className:"col-span-2 lg:col-span-1",children:e.jsxs(D,{className:"flex flex-col gap-2 pb-6 text-info border border-2 border-info",children:[e.jsx("span",{className:"text-md lg:text-xl font-semibold",children:"Anggaran Diajukan"}),e.jsx("span",{className:"text-2xl lg:text-4xl font-bold",children:C(p.total_anggaran)})]})}),e.jsx("div",{className:"col-span-2 lg:col-span-1",children:e.jsxs(D,{className:"flex flex-col gap-2 pb-6 text-success border border-2 border-success",children:[e.jsx("span",{className:"text-md lg:text-xl font-semibold",children:"Anggaran Disetujui"}),e.jsx("span",{className:"text-2xl lg:text-4xl font-bold",children:C(p.total_anggaran_acc)})]})}),e.jsx("div",{className:"col-span-2 lg:col-span-1",children:e.jsxs(D,{className:"flex flex-col gap-2 pb-6 text-warning border border-2 border-warning",children:[e.jsx("span",{className:"text-md lg:text-xl font-semibold",children:"Selisih Anggaran"}),e.jsx("span",{className:"text-2xl lg:text-4xl font-bold",children:C(p.selisih_anggaran)})]})})]}),e.jsxs(D,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{onClick:R,disabled:p.limit_anggaran==0}),E()?e.jsx("button",{className:"rounded-lg bg-transparent text-primary border border-primary group hover:bg-primary hover:text-white w-[37px] h-[37px] flex justify-center items-center",onClick:V,disabled:p.limit_anggaran==0,children:e.jsx(f,{icon:"arrow-clockwise"})}):e.jsx(le,{href:route("perencanaan.view",m),target:"_blank",rel:"noopener noreferrer",className:"rounded-lg bg-transparent text-primary border border-primary group hover:bg-primary hover:text-white w-[37px] h-[37px] flex justify-center items-center",children:e.jsx("i",{className:"bi bi-file-text"})})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("div",{className:"hidden sm:block",children:e.jsxs(w,{prefix:e.jsx(f,{icon:"person-check"}),size:"sm",name:"pic_id",value:m.pic_id,onChange:t,className:"w-[218px]",children:[e.jsx("option",{value:"",children:"Semua Pemegang Anggaran"}),g.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})}),e.jsx("div",{className:"hidden sm:block",children:e.jsxs(w,{prefix:e.jsx(f,{icon:"tag"}),size:"sm",name:"kategori_id",value:m.kategori_id,onChange:t,className:"w-[205px]",children:[e.jsx("option",{value:"",children:"Semua Kategori"}),i.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{className:"hidden sm:block",children:e.jsxs(w,{prefix:e.jsx(f,{icon:"info-circle"}),size:"sm",name:"status",value:m.status,onChange:t,className:"w-[150px]",children:[e.jsx("option",{value:"",children:"Semua Status"}),_.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{children:e.jsxs(w,{prefix:e.jsx(f,{icon:"calendar-month"}),size:"sm",name:"bulan",value:m.bulan?m.bulan:ue(),onChange:t,className:"w-[150px]",children:[e.jsx("option",{value:"all",children:"Semua Bulan"}),ge().map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{className:"hidden sm:block",children:e.jsxs(w,{prefix:e.jsx(f,{icon:"calendar-check"}),size:"sm",name:"tahun",value:m.tahun?m.tahun:je(),onChange:t,className:"w-[150px]",children:[e.jsx("option",{value:"all",children:"Semua Tahun"}),fe().map(a=>e.jsx("option",{value:a,children:a},a))]})}),e.jsx(ce,{onHandleFilter:t})]})]}),e.jsxs(ee,{children:[e.jsxs(n,{children:[e.jsx(n.Thead,{children:e.jsxs(n.TrHead,{children:[e.jsx(n.Th,{width:"4",ordered:!0,onHandleOrder:c,column:"id",orderBy:s.orderBy,orderDirection:s.orderDirection,children:"no"}),e.jsx(n.Th,{width:"15",children:"Pemegang Anggaran"}),e.jsx(n.Th,{width:"15",ordered:!0,onHandleOrder:c,column:"kategori_id",orderBy:s.orderBy,orderDirection:s.orderDirection,children:"Kategori"}),e.jsx(n.Th,{width:"15",children:"Judul"}),e.jsx(n.Th,{width:"10",ordered:!0,onHandleOrder:c,column:"nominal",orderBy:s.orderBy,orderDirection:s.orderDirection,children:"nominal"}),e.jsx(n.Th,{width:"10",ordered:!0,onHandleOrder:c,column:"bulan",orderBy:s.orderBy,orderDirection:s.orderDirection,children:"bulan"}),e.jsx(n.Th,{width:"7",ordered:!0,onHandleOrder:c,column:"tahun",orderBy:s.orderBy,orderDirection:s.orderDirection,children:"tahun"}),e.jsx(n.Th,{width:"7",ordered:!0,onHandleOrder:c,column:"tipe",orderBy:s.orderBy,orderDirection:s.orderDirection,children:"tipe"}),e.jsx(n.Th,{width:"7",ordered:!0,onHandleOrder:c,column:"status",orderBy:s.orderBy,orderDirection:s.orderDirection,children:"status"}),e.jsx(n.Th,{align:"end",width:"10",children:e.jsx("span",{className:"me-3",children:"opsi"})})]})}),e.jsx(n.Tbody,{children:P()})]}),e.jsx(ee.Footer,{data:l,params:s,setParams:z,setFetching:I,onChange:t})]})]}),e.jsx(we,{title:o,showModal:M,closeModal:K,mode:L,data:h,categories:i,users:g,handleChange:j,errors:b,submit:v,update:U,processing:x}),e.jsx(De,{title:o,showModal:Y,closeModal:O,data:N}),e.jsx(Ce,{title:o,showModal:J,closeModal:$,data:N,formData:h,handleChange:j,errors:b,submit:y,processing:x}),e.jsx(Se,{title:o,showModal:Q,closeModal:k,data:h,formData:h,handleChange:j,errors:b,submit:B,processing:x})]})};export{na as default};
