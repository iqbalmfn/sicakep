import{y as Y,W as q,r as p,j as e,Y as J,a as $}from"./app-DFlApHk3.js";import{B as G}from"./Breadcrumbs-BjrdiH-P.js";import{C as Q,a as V,F as X,D as L,T as r,A as W,b as Z}from"./GlobalHooks-DV5wGKq-.js";import{F as z}from"./FormSelectPrefix-DJ3AMdin.js";import{I as K}from"./Icon-cn9wUBGM.js";import{L as ee}from"./Label-ac9xJ9xN.js";import{N as ae}from"./NameWithAvatar-BOSYDjrS.js";import{B as R}from"./react-toastify.esm-B79FFm9e.js";import{U as re}from"./UsePageController-sAsKy6bx.js";import{A as se}from"./AppContentLayout-PZieyMYA.js";import{C as b}from"./ContentWrapper-C-ROliX7.js";import{f as v,b as ne,l as le,a as oe,c as te,d as ie,h as de}from"./GlobalFunction-DFIgSulW.js";import ce from"./PengeluaranCreate-BTGC3M5o.js";import he from"./PengeluaranDetail-BRaQ35I4.js";import"./Button-EegDf8DF.js";import"./clsx-B-dksMZM.js";import"./FormInput-B-KlRyTT.js";import"./RegularSubmitModal-CZi_Y1wF.js";/* empty css                      */import"./transition-ChH6XhK2.js";import"./FormTextarea-Bz8r2obe.js";import"./Modal-CN-7DWmK.js";import"./dialog-DOrzil7_.js";const me=(o,h,t)=>{Y.post(route("transaksi.pengeluaran.store"),o,{onError:i=>{h(i)},onSuccess:()=>{t()},preserveScroll:!1,preserveState:!0})},xe=(o,h,t)=>{Y.post(route("transaksi.pengeluaran.update",{pengeluaran:o.id}),{...o,_method:"PUT"},{onError:i=>{h(i)},onSuccess:()=>{t()},preserveScroll:!1,preserveState:!0})},pe=(o,h)=>{const{data:t,setData:i,reset:u}=q({user_id:"",kategori_id:"",perencanaan_id:"",judul:"",nominal:"",tanggal:"",jenis:"online",deskripsi:""}),[D,j]=p.useState({}),[m,s]=p.useState(null),g=()=>{j({})},{mode:w,params:f,setParams:C,fetching:T,request:k,showModal:y,handleShowModal:d,handleEditModal:S,handleCloseModal:N,initialData:l,setInitialData:M,setFetching:x,onHandleFilter:c,onHandleOrder:_}=re(o,g,u,"transaksi.pengeluaran.index");p.useEffect(()=>{T&&k(f)},[f,T]),p.useEffect(()=>{l.id&&i({id:l.id,user_id:l.user_id,kategori_id:l.kategori_id,perencanaan_id:l.perencanaan_id,judul:l.judul,nominal:l.nominal,nominal_strict:l.nominal,tanggal:l.tanggal,jenis:l.jenis,deskripsi:l.deskripsi})},[l]);const B=n=>{i(n.target.name,n.target.type==="file"?n.target.files[0]:n.target.value)},E=n=>{n.target.checked?i(n.target.name,1):i(n.target.name,0)},P=n=>{n.preventDefault(),s(R.loading("Sedang menyimpan data...")),me(t,j,g)},F=n=>{n.preventDefault(),s(R.loading("Sedang menyimpan data...")),xe(t,j,g)},[A,H]=p.useState({}),[U,a]=p.useState(!1),I=n=>{a(!0),H(n)},O=n=>{a(!1),M({}),u()};return Q(h,D,m,s,N),{data:t,processing:m,errors:D,submit:P,update:F,handleChange:B,handleCheckboxChange:E,mode:w,params:f,setParams:C,setFetching:x,onHandleFilter:c,onHandleOrder:_,showModal:y,handleShowModal:d,handleEditModal:S,handleCloseModal:N,detailData:A,showDetailModal:U,handleShowDetailModal:I,handleCloseDetailModal:O}},Ie=({title:o,breadcrumbs:h,datas:t,dataAll:i,categories:u,users:D,perencanaans:j,widget:m,filtered:s,flash:g})=>{const{data:w,processing:f,errors:C,submit:T,update:k,handleChange:y,params:d,setParams:S,setFetching:N,mode:l,showModal:M,onHandleFilter:x,onHandleOrder:c,handleShowModal:_,handleEditModal:B,handleCloseModal:E,detailData:P,showDetailModal:F,handleShowDetailModal:A,handleCloseDetailModal:H}=pe(s,g),U=()=>t.data.length>0?t.data.map((a,I)=>e.jsxs(r.TrBody,{children:[e.jsx(r.Td,{children:I+1}),e.jsx(r.Td,{children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ae,{avatar:a.user.foto?`/images/${a.user.foto}`:a.user.foto,name:a.user.name})})}),e.jsx(r.Td,{children:a.kategori.nama}),e.jsx(r.Td,{children:a.perencanaan.judul}),e.jsx(r.Td,{children:a.judul}),e.jsx(r.Td,{children:v(a.nominal)}),e.jsx(r.Td,{children:ie(a.tanggal)}),e.jsx(r.Td,{children:e.jsx(ee,{variant:a.jenis=="cash"?"info":"success",children:a.jenis})}),e.jsxs(r.Td,{className:"text-end pe-3",children:[e.jsx(W,{variant:"warning",icon:"search",label:"Detail",onClick:()=>A(a)}),e.jsx(W,{variant:"info",icon:"pencil",label:"Edit",onClick:()=>B(a)}),e.jsx(W,{variant:"danger",icon:"trash",label:"Hapus",onClick:()=>de("transaksi.pemasukan.destroy",a.id,"Data berhasil dihapus")})]})]},a.id)):e.jsx(Z,{colSpan:9});return e.jsxs(se,{children:[e.jsx(J,{title:o}),e.jsx(G,{title:o,breadcrumbs:h}),e.jsxs("div",{className:"grid grid-cols-4 gap-5 mb-5",children:[e.jsx("div",{className:"col-span-4 lg:col-span-1",children:e.jsxs(b,{className:"flex flex-col gap-2 pb-6 text-info border border-2 border-info",children:[e.jsx("span",{className:"text-xl font-semibold",children:"Total Pemasukan"}),e.jsx("span",{className:"text-4xl font-bold",children:v(m.total_pemasukan)})]})}),e.jsx("div",{className:"col-span-4 lg:col-span-1",children:e.jsxs(b,{className:"flex flex-col gap-2 pb-6 text-warning border border-2 border-warning",children:[e.jsx("span",{className:"text-xl font-semibold",children:"Total Anggaran"}),e.jsx("span",{className:"text-4xl font-bold",children:v(m.total_anggaran)})]})}),e.jsx("div",{className:"col-span-4 lg:col-span-1",children:e.jsxs(b,{className:"flex flex-col gap-2 pb-6 text-danger border border-2 border-danger",children:[e.jsx("span",{className:"text-xl font-semibold",children:"Total Pengeluaran"}),e.jsx("span",{className:"text-4xl font-bold",children:v(m.total_pengeluaran)})]})}),e.jsx("div",{className:"col-span-4 lg:col-span-1",children:e.jsxs(b,{className:"flex flex-col gap-2 pb-6 text-success border border-2 border-success",children:[e.jsx("span",{className:"text-xl font-semibold",children:"Dana Tersedia"}),e.jsx("span",{className:"text-4xl font-bold",children:v(m.dana_tersedia)})]})})]}),e.jsxs(b,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{onClick:_}),e.jsx($,{href:route("transaksi.pengeluaran.view",d),target:"_blank",rel:"noopener noreferrer",className:"rounded-lg bg-transparent text-primary border border-primary group hover:bg-primary hover:text-white w-[37px] h-[37px] flex justify-center items-center",children:e.jsx("i",{className:"bi bi-file-text"})})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("div",{children:e.jsxs(z,{prefix:e.jsx(K,{icon:"tag"}),size:"sm",name:"kategori_id",value:d.kategori_id,onChange:x,className:"w-[205px]",children:[e.jsx("option",{value:"",children:"Semua Kategori"}),u.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{children:e.jsxs(z,{prefix:e.jsx(K,{icon:"calendar-month"}),size:"sm",name:"bulan",value:d.bulan?d.bulan:ne(),onChange:x,className:"w-[150px]",children:[e.jsx("option",{value:"all",children:"Semua Bulan"}),le().map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{children:e.jsxs(z,{prefix:e.jsx(K,{icon:"calendar-check"}),size:"sm",name:"tahun",value:d.tahun?d.tahun:oe(),onChange:x,className:"w-[150px]",children:[e.jsx("option",{value:"all",children:"Semua Tahun"}),te().map(a=>e.jsx("option",{value:a,children:a},a))]})}),e.jsx(X,{onHandleFilter:x})]})]}),e.jsxs(L,{children:[e.jsxs(r,{children:[e.jsx(r.Thead,{children:e.jsxs(r.TrHead,{children:[e.jsx(r.Th,{width:"4",ordered:!0,onHandleOrder:c,column:"id",orderBy:s.orderBy,orderDirection:s.orderDirection,children:"no"}),e.jsx(r.Th,{width:"12",children:"Pengguna Dana"}),e.jsx(r.Th,{width:"15",ordered:!0,onHandleOrder:c,column:"kategori_id",orderBy:s.orderBy,orderDirection:s.orderDirection,children:"Kategori"}),e.jsx(r.Th,{width:"12",ordered:!0,onHandleOrder:c,column:"perencanaan_id",orderBy:s.orderBy,orderDirection:s.orderDirection,children:"Sub Kategori"}),e.jsx(r.Th,{width:"15",children:"Judul"}),e.jsx(r.Th,{width:"10",ordered:!0,onHandleOrder:c,column:"nominal",orderBy:s.orderBy,orderDirection:s.orderDirection,children:"nominal"}),e.jsx(r.Th,{width:"13",ordered:!0,onHandleOrder:c,column:"tanggal",orderBy:s.orderBy,orderDirection:s.orderDirection,children:"tanggal"}),e.jsx(r.Th,{width:"7",ordered:!0,onHandleOrder:c,column:"jenis",orderBy:s.orderBy,orderDirection:s.orderDirection,children:"jenis"}),e.jsx(r.Th,{align:"end",width:"9",children:e.jsx("span",{className:"me-3",children:"opsi"})})]})}),e.jsx(r.Tbody,{children:U()})]}),e.jsx(L.Footer,{data:t,params:s,setParams:S,setFetching:N,onChange:x})]})]}),e.jsx(ce,{title:o,showModal:M,closeModal:E,mode:l,data:w,pengeluaranData:i,categories:u,users:D,perencanaans:j,handleChange:y,errors:C,submit:T,update:k,processing:f}),e.jsx(he,{title:o,showModal:F,closeModal:H,data:P})]})};export{Ie as default};
