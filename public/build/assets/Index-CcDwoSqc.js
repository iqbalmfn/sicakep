import{y as $,W as X,r as u,q as Z,j as e,Y as ee,a as ae}from"./app-Cil5Z24u.js";import{B as ne}from"./Breadcrumbs-CCsxuCW-.js";import{C as re,a as se,F as oe,D as G,T as n,A as _,b as le}from"./GlobalHooks-C1lf0MLu.js";import{F as b}from"./FormSelectPrefix-BJJIFNlW.js";import{I as v}from"./Icon-UIIRo8ai.js";import{L as Q}from"./Label-CNJh2mMF.js";import{N as ie}from"./NameWithAvatar-0grkHqv-.js";import{B as J}from"./react-toastify.esm-CpquGGBo.js";import{U as te}from"./UsePageController-qbYsdiXi.js";import{A as ce}from"./AppContentLayout-DhDgwJw1.js";import{C as D}from"./ContentWrapper-C265OgSv.js";import{f as C,b as de,l as he,a as me,c as pe,m as xe,h as ue}from"./GlobalFunction-tjBBXx-T.js";import je from"./PerencanaanCreate-FiqZFCjF.js";import ge from"./PerencanaanDetail-5C2FW9Zq.js";import fe from"./PerencanaanConfirm-BCTQ8pLh.js";import"./Button-C-XosBI_.js";import"./clsx-B-dksMZM.js";import"./FormInput-D2XdtLgf.js";import"./RegularSubmitModal-BJtpgM9y.js";/* empty css                      */import"./transition-BnuYnFtj.js";import"./FormTextarea-BiKCpn9k.js";import"./Modal-DtyBY_4j.js";import"./dialog-W6UZY-Hx.js";const be=(l,h,i)=>{$.post(route("perencanaan.store"),l,{onError:t=>{h(t)},onSuccess:()=>{i()},preserveScroll:!1,preserveState:!0})},ve=(l,h,i)=>{$.post(route("perencanaan.update",{perencanaan:l.id}),{...l,_method:"PUT"},{onError:t=>{h(t)},onSuccess:()=>{i()},preserveScroll:!1,preserveState:!0})},De=(l,h,i)=>{$.post(route("perencanaan.confirm",{perencanaan:l.id}),{...l,_method:"PUT"},{onError:t=>{h(t)},onSuccess:()=>{i()},preserveScroll:!1,preserveState:!0})},Ce=(l,h)=>{const{data:i,setData:t,reset:j}=X({kategori_id:"",pic_id:"",judul:"",nominal:"",bulan:"",tahun:"",tipe:"cash",deskripsi:""}),[m,r]=u.useState({}),[w,p]=u.useState(null),x=()=>{r({})},{mode:S,params:g,setParams:A,fetching:f,request:d,showModal:E,handleShowModal:P,handleEditModal:F,handleCloseModal:N,initialData:o,setInitialData:c,setFetching:H,onHandleFilter:U,onHandleOrder:z}=te(l,x,j,"perencanaan.index");u.useEffect(()=>{f&&d(g)},[g,f]),u.useEffect(()=>{o.id&&t({id:o.id,kategori_id:o.kategori_id,pic_id:o.pic_id,judul:o.judul,nominal:o.nominal,bulan:o.bulan,tahun:o.tahun,tipe:o.tipe,deskripsi:o.deskripsi})},[o]);const T=s=>{t(s.target.name,s.target.type==="file"?s.target.files[0]:s.target.value)},I=s=>{s.target.checked?t(s.target.name,1):t(s.target.name,0)},L=s=>{s.preventDefault(),p(J.loading("Sedang menyimpan data...")),be(i,r,x)},R=s=>{s.preventDefault(),p(J.loading("Sedang menyimpan data...")),ve(i,r,x)},[W,M]=u.useState({}),[K,y]=u.useState(!1),Y=s=>{y(!0),M(s)},q=s=>{y(!1),c({}),j()},[k,a]=u.useState(!1),O=s=>{a(!0),M(s),c(s)},B=s=>{a(!1),c({}),j()},V=s=>{s.preventDefault(),p(J.loading("Sedang memproses data...")),De(i,r,x)};return re(h,m,w,p,k?B:N),{data:i,processing:w,errors:m,submit:L,update:R,handleChange:T,handleCheckboxChange:I,mode:S,params:g,setParams:A,setFetching:H,onHandleFilter:U,onHandleOrder:z,showModal:E,handleShowModal:P,handleEditModal:F,handleCloseModal:N,detailData:W,showDetailModal:K,handleShowDetailModal:Y,handleCloseDetailModal:q,showConfirmModal:k,handleShowConfirmModal:O,handleCloseConfirmModal:B,confirm:V}},Je=({title:l,breadcrumbs:h,datas:i,categories:t,users:j,widget:m,filtered:r,flash:w})=>{const{data:p,processing:x,errors:S,submit:g,update:A,handleChange:f,params:d,setParams:E,setFetching:P,mode:F,showModal:N,onHandleFilter:o,onHandleOrder:c,handleShowModal:H,handleEditModal:U,handleCloseModal:z,detailData:T,showDetailModal:I,handleShowDetailModal:L,handleCloseDetailModal:R,showConfirmModal:W,handleShowConfirmModal:M,handleCloseConfirmModal:K,confirm:y}=Ce(r,w),{auth:Y}=Z().props,q=[{value:"waiting",label:"Waiting"},{value:1,label:"Accept"},{value:0,label:"Reject"}],k=()=>i.data.length>0?i.data.map((a,O)=>e.jsxs(n.TrBody,{children:[e.jsx(n.Td,{children:O+1}),e.jsx(n.Td,{children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ie,{avatar:a.pic.foto?`/images/${a.pic.foto}`:a.pic.foto,name:a.pic.name})})}),e.jsx(n.Td,{children:a.kategori.nama}),e.jsx(n.Td,{children:a.judul}),e.jsx(n.Td,{children:C(a.nominal)}),e.jsx(n.Td,{children:xe(a.bulan)}),e.jsx(n.Td,{children:a.tahun}),e.jsx(n.Td,{children:e.jsx(Q,{variant:a.tipe=="cash"?"info":"success",children:a.tipe})}),e.jsx(n.Td,{children:e.jsx(Q,{variant:a.status==0?"danger":a.status==1?"success":"warning",children:a.status==0?"reject":a.status==1?"accept":"waiting"})}),e.jsxs(n.Td,{className:"text-end pe-3",children:[Y.user.roles.find(B=>B.name==="Admin")&&a.status==null?e.jsx(_,{variant:"success",icon:"check-lg",label:"Konfirmasi",onClick:()=>M(a)}):e.jsx(_,{variant:"warning",icon:"search",label:"Detail",onClick:()=>L(a)}),e.jsx(_,{variant:"info",icon:"pencil",label:"Edit",onClick:()=>U(a)}),e.jsx(_,{variant:"danger",icon:"trash",label:"Hapus",onClick:()=>ue("perencanaan.destroy",a.id,"Data berhasil dihapus")})]})]},a.id)):e.jsx(le,{colSpan:10});return e.jsxs(ce,{children:[e.jsx(ee,{title:l}),e.jsx(ne,{title:l,breadcrumbs:h}),e.jsxs("div",{className:"grid grid-cols-4 gap-5 mb-5",children:[e.jsx("div",{className:"col-span-4 lg:col-span-1",children:e.jsxs(D,{className:"flex flex-col gap-2 pb-6 text-danger border border-2 border-danger",children:[e.jsx("span",{className:"text-xl font-semibold",children:"Limit Anggaran"}),e.jsx("span",{className:"text-4xl font-bold",children:C(m.limit_anggaran)})]})}),e.jsx("div",{className:"col-span-4 lg:col-span-1",children:e.jsxs(D,{className:"flex flex-col gap-2 pb-6 text-info border border-2 border-info",children:[e.jsx("span",{className:"text-xl font-semibold",children:"Anggaran Diajukan"}),e.jsx("span",{className:"text-4xl font-bold",children:C(m.total_anggaran)})]})}),e.jsx("div",{className:"col-span-4 lg:col-span-1",children:e.jsxs(D,{className:"flex flex-col gap-2 pb-6 text-success border border-2 border-success",children:[e.jsx("span",{className:"text-xl font-semibold",children:"Anggaran Disetujui"}),e.jsx("span",{className:"text-4xl font-bold",children:C(m.total_anggaran_acc)})]})}),e.jsx("div",{className:"col-span-4 lg:col-span-1",children:e.jsxs(D,{className:"flex flex-col gap-2 pb-6 text-warning border border-2 border-warning",children:[e.jsx("span",{className:"text-xl font-semibold",children:"Selisih Anggaran"}),e.jsx("span",{className:"text-4xl font-bold",children:C(m.selisih_anggaran)})]})})]}),e.jsxs(D,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{onClick:H,disabled:m.limit_anggaran==0}),e.jsx(ae,{href:route("perencanaan.view",d),target:"_blank",rel:"noopener noreferrer",className:"rounded-lg bg-transparent text-primary border border-primary group hover:bg-primary hover:text-white w-[37px] h-[37px] flex justify-center items-center",children:e.jsx("i",{className:"bi bi-file-text"})})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("div",{children:e.jsxs(b,{prefix:e.jsx(v,{icon:"person-check"}),size:"sm",name:"pic_id",value:d.pic_id,onChange:o,className:"w-[218px]",children:[e.jsx("option",{value:"",children:"Semua Pemegang Anggaran"}),j.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})}),e.jsx("div",{children:e.jsxs(b,{prefix:e.jsx(v,{icon:"tag"}),size:"sm",name:"kategori_id",value:d.kategori_id,onChange:o,className:"w-[205px]",children:[e.jsx("option",{value:"",children:"Semua Kategori"}),t.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{children:e.jsxs(b,{prefix:e.jsx(v,{icon:"info-circle"}),size:"sm",name:"status",value:d.status,onChange:o,className:"w-[150px]",children:[e.jsx("option",{value:"",children:"Semua Status"}),q.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{children:e.jsxs(b,{prefix:e.jsx(v,{icon:"calendar-month"}),size:"sm",name:"bulan",value:d.bulan?d.bulan:de(),onChange:o,className:"w-[150px]",children:[e.jsx("option",{value:"all",children:"Semua Bulan"}),he().map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{children:e.jsxs(b,{prefix:e.jsx(v,{icon:"calendar-check"}),size:"sm",name:"tahun",value:d.tahun?d.tahun:me(),onChange:o,className:"w-[150px]",children:[e.jsx("option",{value:"all",children:"Semua Tahun"}),pe().map(a=>e.jsx("option",{value:a,children:a},a))]})}),e.jsx(oe,{onHandleFilter:o})]})]}),e.jsxs(G,{children:[e.jsxs(n,{children:[e.jsx(n.Thead,{children:e.jsxs(n.TrHead,{children:[e.jsx(n.Th,{width:"4",ordered:!0,onHandleOrder:c,column:"id",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"no"}),e.jsx(n.Th,{width:"15",children:"Pemegang Anggaran"}),e.jsx(n.Th,{width:"15",ordered:!0,onHandleOrder:c,column:"kategori_id",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"Kategori"}),e.jsx(n.Th,{width:"15",children:"Judul"}),e.jsx(n.Th,{width:"10",ordered:!0,onHandleOrder:c,column:"nominal",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"nominal"}),e.jsx(n.Th,{width:"10",ordered:!0,onHandleOrder:c,column:"bulan",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"bulan"}),e.jsx(n.Th,{width:"7",ordered:!0,onHandleOrder:c,column:"tahun",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"tahun"}),e.jsx(n.Th,{width:"7",ordered:!0,onHandleOrder:c,column:"tipe",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"tipe"}),e.jsx(n.Th,{width:"7",ordered:!0,onHandleOrder:c,column:"status",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"status"}),e.jsx(n.Th,{align:"end",width:"10",children:e.jsx("span",{className:"me-3",children:"opsi"})})]})}),e.jsx(n.Tbody,{children:k()})]}),e.jsx(G.Footer,{data:i,params:r,setParams:E,setFetching:P,onChange:o})]})]}),e.jsx(je,{title:l,showModal:N,closeModal:z,mode:F,data:p,categories:t,users:j,handleChange:f,errors:S,submit:g,update:A,processing:x}),e.jsx(ge,{title:l,showModal:I,closeModal:R,data:T}),e.jsx(fe,{title:l,showModal:W,closeModal:K,data:T,formData:p,handleChange:f,errors:S,submit:y,processing:x})]})};export{Je as default};
