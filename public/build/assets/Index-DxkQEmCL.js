import{W as Z,r as o,j as a,Y as aa}from"./app-Dn5xKvvL.js";import{B as ea}from"./Breadcrumbs-BxDTUTNb.js";import{C as sa,a as na,D as J,T as n,A as k,b as ta,F as ra}from"./GlobalHooks-2TjRKrGq.js";import{F as K}from"./FormSelectPrefix-Dxdueh9-.js";import{I as Q}from"./Icon-DbejrDvs.js";import{L as V}from"./Label-CPu-McUU.js";import{N as ia}from"./NameWithAvatar-I85IDxuP.js";import{B as G}from"./react-toastify.esm-CFvgiqJT.js";import{U as oa}from"./UsePageController-C_aQC9qd.js";import{A as la}from"./AppContentLayout-CEyRb5OV.js";import{C as da}from"./ContentWrapper-Bte15Bgr.js";import{f as ca,d as X,h as ma}from"./GlobalFunction-BmrR9aro.js";import{p as ha,a as ua,u as pa}from"./UtangPiutangServices-BhTIem5P.js";import ga from"./PiutangCreate-BvBJFBOY.js";import xa from"./PiutangDetail-CondoZNW.js";import ja from"./PiutangTransaksi-BiLW-2yi.js";import"./Button-C8xcn-E-.js";import"./clsx-B-dksMZM.js";import"./FormInput-vY0cUITq.js";import"./RegularSubmitModal-DGhL8WCu.js";/* empty css                      */import"./transition-BENWUIyi.js";import"./FormTextarea-ByUYj9u9.js";import"./Modal-rntdvWDm.js";import"./dialog-B4jZ96YY.js";const fa=(h,y)=>{const{data:i,setData:l,reset:u}=Z({user_id:"",nama:"",jenis:"transfer",nominal:"",tanggal:"",jatuh_tempo:"",deskripsi:""}),[x,t]=o.useState({}),[j,d]=o.useState(null),c=()=>{t({})},{mode:f,params:p,setParams:b,fetching:D,request:T,showModal:S,handleShowModal:B,handleEditModal:C,handleCloseModal:w,initialData:r,setInitialData:m,setFetching:_,onHandleFilter:P,onHandleOrder:E}=oa(h,c,u,"utang-piutang.piutang.index");o.useEffect(()=>{D&&T(p)},[p,D]),o.useEffect(()=>{r.id&&l({id:r.id,user_id:r.user_id,nama:r.nama,tanggal:r.tanggal,jatuh_tempo:r.jatuh_tempo,nominal:r.nominal,deskripsi:r.deskripsi})},[r]);const N=s=>{l(s.target.name,s.target.type==="file"?s.target.files[0]:s.target.value)},F=s=>{s.target.checked?l(s.target.name,1):l(s.target.name,0)},A=s=>{s.preventDefault(),d(G.loading("Sedang menyimpan data...")),ha(i,t,c)},L=s=>{s.preventDefault(),d(G.loading("Sedang menyimpan data...")),ua(i,t,c)},[H,I]=o.useState({}),[R,v]=o.useState(!1),U=s=>{v(!0),I(s)},W=s=>{v(!1),m({}),u()},[M,z]=o.useState({}),[O,e]=o.useState(!1),q=s=>{e(!0),z(s),l({user_id:s.user_id,piutang_master_id:s.id,judul:"",tipe:"piutang",jenis:"transfer",nominal:"",jatuh_tempo:"",deskripsi:""})},g=s=>{e(!1),m({}),u()},Y=s=>{l(s.target.name,s.target.type==="file"?s.target.files[0]:s.target.value)},$=s=>{s.preventDefault(),d(G.loading("Sedang menyimpan data...")),pa(i,t,c)};return sa(y,x,j,d,M?g:w),{data:i,processing:j,errors:x,submit:A,update:L,handleChange:N,handleCheckboxChange:F,mode:f,params:p,setParams:b,setFetching:_,onHandleFilter:P,onHandleOrder:E,showModal:S,handleShowModal:B,handleEditModal:C,handleCloseModal:w,detailData:H,showDetailModal:R,handleShowDetailModal:U,handleCloseDetailModal:W,transaksi:M,showTransaksiModal:O,handleShowTransaksiModal:q,handleCloseTransaksiModal:g,handleChangeTransaksi:Y,submitPiutang:$}},qa=({title:h,breadcrumbs:y,datas:i,widget:l,peminjams:u,users:x,filtered:t,flash:j})=>{const{data:d,processing:c,errors:f,submit:p,update:b,handleChange:D,params:T,setParams:S,setFetching:B,mode:C,showModal:w,onHandleFilter:r,onHandleOrder:m,handleShowModal:_,handleEditModal:P,handleCloseModal:E,detailData:N,showDetailModal:F,handleShowDetailModal:A,handleCloseDetailModal:L,transaksi:H,showTransaksiModal:I,handleShowTransaksiModal:R,handleCloseTransaksiModal:v,handleChangeTransaksi:U,submitPiutang:W}=fa(t,j),M=[{value:0,label:"Belum Lunas"},{value:1,label:"Lunas"}],z=()=>i.data.length>0?i.data.map((e,q)=>{const g=Array.isArray(e.piutang_detail)?e.piutang_detail.reduce((Y,$)=>Y+$.nominal,0):0;return a.jsxs(n.TrBody,{children:[a.jsx(n.Td,{children:q+1}),a.jsx(n.Td,{children:a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(ia,{avatar:e.user.foto?`/images/${e.user.foto}`:e.user.foto,name:e.user.name})})}),a.jsx(n.Td,{children:e.nama}),a.jsx(n.Td,{children:ca(e.nominal)}),a.jsx(n.Td,{children:X(e.tanggal)}),a.jsx(n.Td,{children:e.jatuh_tempo?X(e.jatuh_tempo):a.jsx(V,{variant:"info",children:"Tidak Ditentukan"})}),a.jsx(n.Td,{children:a.jsx(V,{variant:e.nominal<=g?"success":"danger",children:e.nominal<=g?"Lunas":"Belum Lunas"})}),a.jsxs(n.Td,{className:"text-end pe-3",children:[a.jsx(k,{variant:"warning",icon:"search",label:"Detail",onClick:()=>A(e)}),a.jsx(k,{variant:"success",icon:"currency-dollar",label:"Bayar",onClick:()=>R(e)}),a.jsx(k,{variant:"info",icon:"pencil",label:"Edit",onClick:()=>P(e)}),a.jsx(k,{variant:"danger",icon:"trash",label:"Hapus",onClick:()=>ma("utang-piutang.piutang.destroy",e.id,"Data berhasil dihapus")})]})]},e.id)}):a.jsx(ta,{colSpan:8}),O=()=>a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("div",{children:a.jsxs(K,{prefix:a.jsx(Q,{icon:"person"}),size:"sm",name:"nama",value:T.nama,onChange:r,className:"w-[205px]",children:[a.jsx("option",{value:"",children:"Semua Peminjam"}),u.map(e=>a.jsx("option",{value:e.nama,children:e.nama},e.id))]})}),a.jsx("div",{children:a.jsxs(K,{prefix:a.jsx(Q,{icon:"check-circle"}),size:"sm",name:"status",value:T.status,onChange:r,className:"w-[150px]",children:[a.jsx("option",{value:"",children:"Semua Status"}),M.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))]})}),a.jsx(ra,{onHandleFilter:r})]});return a.jsxs(la,{children:[a.jsx(aa,{title:h}),a.jsx(ea,{title:h,breadcrumbs:y}),a.jsxs(da,{children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(na,{onClick:_})}),O()]}),a.jsxs(J,{children:[a.jsxs(n,{children:[a.jsx(n.Thead,{children:a.jsxs(n.TrHead,{children:[a.jsx(n.Th,{width:"4",ordered:!0,onHandleOrder:m,column:"id",orderBy:t.orderBy,orderDirection:t.orderDirection,children:"no"}),a.jsx(n.Th,{width:"15",children:"Donatur"}),a.jsx(n.Th,{width:"15",children:"Peminjam"}),a.jsx(n.Th,{width:"10",ordered:!0,onHandleOrder:m,column:"nominal",orderBy:t.orderBy,orderDirection:t.orderDirection,children:"nominal"}),a.jsx(n.Th,{width:"10",ordered:!0,onHandleOrder:m,column:"tanggal",orderBy:t.orderBy,orderDirection:t.orderDirection,children:"tanggal meminjam"}),a.jsx(n.Th,{width:"10",ordered:!0,onHandleOrder:m,column:"jatuh_tempo",orderBy:t.orderBy,orderDirection:t.orderDirection,children:"janji bayar"}),a.jsx(n.Th,{width:"7",children:"status"}),a.jsx(n.Th,{align:"end",width:"10",children:a.jsx("span",{className:"me-3",children:"opsi"})})]})}),a.jsx(n.Tbody,{children:z()})]}),a.jsx(J.Footer,{data:i,params:t,setParams:S,setFetching:B,onChange:r})]})]}),a.jsx(ga,{title:h,showModal:w,closeModal:E,mode:C,data:d,users:x,handleChange:D,errors:f,submit:p,update:b,processing:c}),a.jsx(ja,{showModal:I,closeModal:v,mode:C,data:d,dataTransaksi:H,handleChange:U,errors:f,submit:W,processing:c}),a.jsx(xa,{title:h,showModal:F,closeModal:L,data:N})]})};export{qa as default};
