import{y as K,W as O,r as u,j as e,Y,a as q}from"./app-khPyyK-E.js";import{B as J,C as $}from"./ContentWrapper-BMR15iZw.js";import{U as G,C as Q,a as V,F as X,D as W,T as r,A,b as Z}from"./UsePageController-BmsKZ5kP.js";import{F as U}from"./FormSelectPrefix-DWcSLrHb.js";import{I}from"./Button-Dp62ijLc.js";import{L as ee}from"./Label-JhmnwH6K.js";import{N as ae}from"./NameWithAvatar-Bjs4SFfm.js";import{B as z}from"./react-toastify.esm-Dv8cz7qT.js";import{A as re}from"./AppContentLayout-BXGPtaf4.js";import{l as ne,a as se,f as oe,b as ie,h as te}from"./GlobalFunction-B7s3KAFw.js";import le from"./PengeluaranCreate-BwLuxVvb.js";import de from"./PengeluaranDetail-jAaJV3Lk.js";import"./clsx-B-dksMZM.js";import"./FormInput-DM7GuzKE.js";import"./RegularSubmitModal-B5MkYYuF.js";/* empty css                      */import"./transition-CyX9F3PE.js";import"./FormTextarea-CtGTBWKs.js";import"./Modal-ptuuVaiO.js";import"./dialog-BJT0psZ1.js";const ce=(i,c,t)=>{K.post(route("transaksi.pengeluaran.store"),i,{onError:l=>{c(l)},onSuccess:()=>{t()},preserveScroll:!1,preserveState:!0})},he=(i,c,t)=>{K.post(route("transaksi.pengeluaran.update",{pengeluaran:i.id}),{...i,_method:"PUT"},{onError:l=>{c(l)},onSuccess:()=>{t()},preserveScroll:!1,preserveState:!0})},me=(i,c)=>{const{data:t,setData:l,reset:p}=O({user_id:"",kategori_id:"",perencanaan_id:"",judul:"",nominal:"",tanggal:"",jenis:"online",deskripsi:""}),[D,x]=u.useState({}),[n,j]=u.useState(null),g=()=>{x({})},{mode:w,params:f,setParams:y,fetching:v,request:C,showModal:m,handleShowModal:S,handleEditModal:k,handleCloseModal:T,initialData:o,setInitialData:h,setFetching:d,onHandleFilter:B,onHandleOrder:M}=G(i,g,p,"transaksi.pengeluaran.index");u.useEffect(()=>{v&&C(f)},[f,v]),u.useEffect(()=>{o.id&&l({id:o.id,user_id:o.user_id,kategori_id:o.kategori_id,perencanaan_id:o.perencanaan_id,judul:o.judul,nominal:o.nominal,nominal_strict:o.nominal,tanggal:o.tanggal,jenis:o.jenis,deskripsi:o.deskripsi})},[o]);const _=s=>{l(s.target.name,s.target.type==="file"?s.target.files[0]:s.target.value)},N=s=>{s.target.checked?l(s.target.name,1):l(s.target.name,0)},E=s=>{s.preventDefault(),j(z.loading("Sedang menyimpan data...")),ce(t,x,g)},P=s=>{s.preventDefault(),j(z.loading("Sedang menyimpan data...")),he(t,x,g)},[F,H]=u.useState({}),[a,b]=u.useState(!1),L=s=>{b(!0),H(s)},R=s=>{b(!1),h({}),p()};return Q(c,D,n,j,T),{data:t,processing:n,errors:D,submit:E,update:P,handleChange:_,handleCheckboxChange:N,mode:w,params:f,setParams:y,setFetching:d,onHandleFilter:B,onHandleOrder:M,showModal:m,handleShowModal:S,handleEditModal:k,handleCloseModal:T,detailData:F,showDetailModal:a,handleShowDetailModal:L,handleCloseDetailModal:R}},Pe=({title:i,breadcrumbs:c,datas:t,dataAll:l,categories:p,users:D,perencanaans:x,filtered:n,flash:j})=>{const{data:g,processing:w,errors:f,submit:y,update:v,handleChange:C,params:m,setParams:S,setFetching:k,mode:T,showModal:o,onHandleFilter:h,onHandleOrder:d,handleShowModal:B,handleEditModal:M,handleCloseModal:_,detailData:N,showDetailModal:E,handleShowDetailModal:P,handleCloseDetailModal:F}=me(n,j),H=()=>t.data.length>0?t.data.map((a,b)=>e.jsxs(r.TrBody,{children:[e.jsx(r.Td,{children:b+1}),e.jsx(r.Td,{children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ae,{avatar:a.user.foto?`/images/${a.user.foto}`:a.user.foto,name:a.user.name})})}),e.jsx(r.Td,{children:a.kategori.nama}),e.jsx(r.Td,{children:a.perencanaan.judul}),e.jsx(r.Td,{children:a.judul}),e.jsx(r.Td,{children:oe(a.nominal)}),e.jsx(r.Td,{children:ie(a.tanggal)}),e.jsx(r.Td,{children:e.jsx(ee,{variant:a.jenis=="cash"?"info":"success",children:a.jenis})}),e.jsxs(r.Td,{className:"text-end pe-3",children:[e.jsx(A,{variant:"warning",icon:"search",label:"Detail",onClick:()=>P(a)}),e.jsx(A,{variant:"info",icon:"pencil",label:"Edit",onClick:()=>M(a)}),e.jsx(A,{variant:"danger",icon:"trash",label:"Hapus",onClick:()=>te("transaksi.pemasukan.destroy",a.id,"Data berhasil dihapus")})]})]},a.id)):e.jsx(Z,{colSpan:9});return e.jsxs(re,{children:[e.jsx(Y,{title:i}),e.jsx(J,{title:i,breadcrumbs:c}),e.jsxs($,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{onClick:B}),e.jsx(q,{href:route("perencanaan.view",m),target:"_blank",rel:"noopener noreferrer",className:"rounded-lg bg-transparent text-primary border border-primary group hover:bg-primary hover:text-white w-[37px] h-[37px] flex justify-center items-center",children:e.jsx("i",{className:"bi bi-file-text"})})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("div",{children:e.jsxs(U,{prefix:e.jsx(I,{icon:"tag"}),size:"sm",name:"kategori_id",value:m.kategori_id,onChange:h,className:"w-[205px]",children:[e.jsx("option",{value:"",children:"Semua Kategori"}),p.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{children:e.jsxs(U,{prefix:e.jsx(I,{icon:"calendar-month"}),size:"sm",name:"bulan",value:m.bulan,onChange:h,className:"w-[150px]",children:[e.jsx("option",{value:"",children:"Semua Bulan"}),ne().map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{children:e.jsxs(U,{prefix:e.jsx(I,{icon:"calendar-check"}),size:"sm",name:"tahun",value:m.tahun,onChange:h,className:"w-[150px]",children:[e.jsx("option",{value:"",children:"Semua Tahun"}),se().map(a=>e.jsx("option",{value:a,children:a},a))]})}),e.jsx(X,{onHandleFilter:h})]})]}),e.jsxs(W,{children:[e.jsxs(r,{children:[e.jsx(r.Thead,{children:e.jsxs(r.TrHead,{children:[e.jsx(r.Th,{width:"4",ordered:!0,onHandleOrder:d,column:"id",orderBy:n.orderBy,orderDirection:n.orderDirection,children:"no"}),e.jsx(r.Th,{width:"12",children:"Pengguna Dana"}),e.jsx(r.Th,{width:"15",ordered:!0,onHandleOrder:d,column:"kategori_id",orderBy:n.orderBy,orderDirection:n.orderDirection,children:"Kategori"}),e.jsx(r.Th,{width:"12",ordered:!0,onHandleOrder:d,column:"perencanaan_id",orderBy:n.orderBy,orderDirection:n.orderDirection,children:"Sub Kategori"}),e.jsx(r.Th,{width:"15",children:"Judul"}),e.jsx(r.Th,{width:"10",ordered:!0,onHandleOrder:d,column:"nominal",orderBy:n.orderBy,orderDirection:n.orderDirection,children:"nominal"}),e.jsx(r.Th,{width:"13",ordered:!0,onHandleOrder:d,column:"tanggal",orderBy:n.orderBy,orderDirection:n.orderDirection,children:"tanggal"}),e.jsx(r.Th,{width:"7",ordered:!0,onHandleOrder:d,column:"jenis",orderBy:n.orderBy,orderDirection:n.orderDirection,children:"jenis"}),e.jsx(r.Th,{align:"end",width:"9",children:e.jsx("span",{className:"me-3",children:"opsi"})})]})}),e.jsx(r.Tbody,{children:H()})]}),e.jsx(W.Footer,{data:t,params:n,setParams:S,setFetching:k,onChange:h})]})]}),e.jsx(le,{title:i,showModal:o,closeModal:_,mode:T,data:g,pengeluaranData:l.data,categories:p,users:D,perencanaans:x,handleChange:C,errors:f,submit:y,update:v,processing:w}),e.jsx(de,{title:i,showModal:E,closeModal:F,data:N})]})};export{Pe as default};
