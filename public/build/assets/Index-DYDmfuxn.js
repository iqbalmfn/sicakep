import{y as $,W as X,r as x,q as Z,j as e,Y as ee,a as ae}from"./app-CE2gl90c.js";import{B as ne,C as N}from"./ContentWrapper-TAmVYb0a.js";import{U as re,C as se,a as oe,F as ie,D as G,T as n,A as y,b as le}from"./UsePageController-DP_--MzF.js";import{F as k}from"./FormSelectPrefix-CuvoDRax.js";import{I as B}from"./Button-hCfBrZSe.js";import{L as Q}from"./Label-DOYYIV0I.js";import{N as te}from"./NameWithAvatar-DEegFWbF.js";import{B as J}from"./react-toastify.esm-q1LjlbDt.js";import{A as de}from"./AppContentLayout-DmU2wRGX.js";import{f as _,l as ce,a as he,m as me,h as pe}from"./GlobalFunction-kgZYZnJw.js";import ue from"./PerencanaanCreate-9VRgIH_t.js";import xe from"./PerencanaanDetail-B3OYtMEh.js";import je from"./PerencanaanConfirm-B6G3iQgk.js";import"./clsx-B-dksMZM.js";import"./FormInput-nc5-t1Cg.js";import"./RegularSubmitModal-Dl6Cfvic.js";/* empty css                      */import"./transition-C_dZkoCB.js";import"./FormTextarea-D6YHYrs3.js";import"./Modal-wsSK_kDH.js";import"./dialog-Bsl_4sQK.js";const ge=(i,c,l)=>{$.post(route("perencanaan.store"),i,{onError:t=>{c(t)},onSuccess:()=>{l()},preserveScroll:!1,preserveState:!0})},fe=(i,c,l)=>{$.post(route("perencanaan.update",{perencanaan:i.id}),{...i,_method:"PUT"},{onError:t=>{c(t)},onSuccess:()=>{l()},preserveScroll:!1,preserveState:!0})},be=(i,c,l)=>{$.post(route("perencanaan.confirm",{perencanaan:i.id}),{...i,_method:"PUT"},{onError:t=>{c(t)},onSuccess:()=>{l()},preserveScroll:!1,preserveState:!0})},ve=(i,c)=>{const{data:l,setData:t,reset:j}=X({kategori_id:"",pic_id:"",judul:"",nominal:"",bulan:"",tahun:"",tipe:"cash",deskripsi:""}),[h,r]=x.useState({}),[b,m]=x.useState(null),p=()=>{r({})},{mode:v,params:g,setParams:E,fetching:f,request:u,showModal:P,handleShowModal:A,handleEditModal:F,handleCloseModal:D,initialData:o,setInitialData:d,setFetching:H,onHandleFilter:U,onHandleOrder:I}=re(i,p,j,"perencanaan.index");x.useEffect(()=>{f&&u(g)},[g,f]),x.useEffect(()=>{o.id&&t({id:o.id,kategori_id:o.kategori_id,pic_id:o.pic_id,judul:o.judul,nominal:o.nominal,bulan:o.bulan,tahun:o.tahun,tipe:o.tipe,deskripsi:o.deskripsi})},[o]);const C=s=>{t(s.target.name,s.target.type==="file"?s.target.files[0]:s.target.value)},z=s=>{s.target.checked?t(s.target.name,1):t(s.target.name,0)},L=s=>{s.preventDefault(),m(J.loading("Sedang menyimpan data...")),ge(l,r,p)},R=s=>{s.preventDefault(),m(J.loading("Sedang menyimpan data...")),fe(l,r,p)},[W,w]=x.useState({}),[K,S]=x.useState(!1),q=s=>{S(!0),w(s)},O=s=>{S(!1),d({}),j()},[T,a]=x.useState(!1),Y=s=>{a(!0),w(s),d(s)},M=s=>{a(!1),d({}),j()},V=s=>{s.preventDefault(),m(J.loading("Sedang memproses data...")),be(l,r,p)};return se(c,h,b,m,T?M:D),{data:l,processing:b,errors:h,submit:L,update:R,handleChange:C,handleCheckboxChange:z,mode:v,params:g,setParams:E,setFetching:H,onHandleFilter:U,onHandleOrder:I,showModal:P,handleShowModal:A,handleEditModal:F,handleCloseModal:D,detailData:W,showDetailModal:K,handleShowDetailModal:q,handleCloseDetailModal:O,showConfirmModal:T,handleShowConfirmModal:Y,handleCloseConfirmModal:M,confirm:V}},We=({title:i,breadcrumbs:c,datas:l,categories:t,users:j,widget:h,filtered:r,flash:b})=>{const{data:m,processing:p,errors:v,submit:g,update:E,handleChange:f,params:u,setParams:P,setFetching:A,mode:F,showModal:D,onHandleFilter:o,onHandleOrder:d,handleShowModal:H,handleEditModal:U,handleCloseModal:I,detailData:C,showDetailModal:z,handleShowDetailModal:L,handleCloseDetailModal:R,showConfirmModal:W,handleShowConfirmModal:w,handleCloseConfirmModal:K,confirm:S}=ve(r,b),{auth:q}=Z().props,O=[{value:"waiting",label:"Waiting"},{value:1,label:"Accept"},{value:0,label:"Reject"}],T=()=>l.data.length>0?l.data.map((a,Y)=>e.jsxs(n.TrBody,{children:[e.jsx(n.Td,{children:Y+1}),e.jsx(n.Td,{children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(te,{avatar:a.pic.foto?`/images/${a.pic.foto}`:a.pic.foto,name:a.pic.name})})}),e.jsx(n.Td,{children:a.kategori.nama}),e.jsx(n.Td,{children:a.judul}),e.jsx(n.Td,{children:_(a.nominal)}),e.jsx(n.Td,{children:me(a.bulan)}),e.jsx(n.Td,{children:a.tahun}),e.jsx(n.Td,{children:e.jsx(Q,{variant:a.tipe=="cash"?"info":"success",children:a.tipe})}),e.jsx(n.Td,{children:e.jsx(Q,{variant:a.status==0?"danger":a.status==1?"success":"warning",children:a.status==0?"reject":a.status==1?"accept":"waiting"})}),e.jsxs(n.Td,{className:"text-end pe-3",children:[q.user.roles.find(M=>M.name==="Admin")&&a.status==null?e.jsx(y,{variant:"success",icon:"check-lg",label:"Konfirmasi",onClick:()=>w(a)}):e.jsx(y,{variant:"warning",icon:"search",label:"Detail",onClick:()=>L(a)}),e.jsx(y,{variant:"info",icon:"pencil",label:"Edit",onClick:()=>U(a)}),e.jsx(y,{variant:"danger",icon:"trash",label:"Hapus",onClick:()=>pe("perencanaan.destroy",a.id,"Data berhasil dihapus")})]})]},a.id)):e.jsx(le,{colSpan:10});return e.jsxs(de,{children:[e.jsx(ee,{title:i}),e.jsx(ne,{title:i,breadcrumbs:c}),e.jsxs("div",{className:"grid grid-cols-3 gap-5 mb-5",children:[e.jsx("div",{className:"col-span-3 lg:col-span-1",children:e.jsxs(N,{className:"flex flex-col gap-2 pb-6 text-danger border border-2 border-danger",children:[e.jsx("span",{className:"text-xl font-semibold",children:"Limit Anggaran"}),e.jsx("span",{className:"text-4xl font-bold",children:_(h.limit_anggaran)})]})}),e.jsx("div",{className:"col-span-3 lg:col-span-1",children:e.jsxs(N,{className:"flex flex-col gap-2 pb-6 text-info border border-2 border-info",children:[e.jsx("span",{className:"text-xl font-semibold",children:"Anggaran Diajukan"}),e.jsx("span",{className:"text-4xl font-bold",children:_(h.total_anggaran)})]})}),e.jsx("div",{className:"col-span-3 lg:col-span-1",children:e.jsxs(N,{className:"flex flex-col gap-2 pb-6 text-success border border-2 border-success",children:[e.jsx("span",{className:"text-xl font-semibold",children:"Anggaran Disetujui"}),e.jsx("span",{className:"text-4xl font-bold",children:_(h.total_anggaran_acc)})]})})]}),e.jsxs(N,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{onClick:H,disabled:h.limit_anggaran==0}),e.jsx(ae,{href:route("perencanaan.view",u),target:"_blank",rel:"noopener noreferrer",className:"rounded-lg bg-transparent text-primary border border-primary group hover:bg-primary hover:text-white w-[37px] h-[37px] flex justify-center items-center",children:e.jsx("i",{className:"bi bi-file-text"})})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("div",{children:e.jsxs(k,{prefix:e.jsx(B,{icon:"tag"}),size:"sm",name:"kategori_id",value:u.kategori_id,onChange:o,className:"w-[205px]",children:[e.jsx("option",{value:"",children:"Semua Kategori"}),t.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{children:e.jsxs(k,{prefix:e.jsx(B,{icon:"info-circle"}),size:"sm",name:"status",value:u.status,onChange:o,className:"w-[150px]",children:[e.jsx("option",{value:"",children:"Semua Status"}),O.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{children:e.jsxs(k,{prefix:e.jsx(B,{icon:"calendar-month"}),size:"sm",name:"bulan",value:u.bulan,onChange:o,className:"w-[150px]",children:[e.jsx("option",{value:"",children:"Semua Bulan"}),ce().map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{children:e.jsxs(k,{prefix:e.jsx(B,{icon:"calendar-check"}),size:"sm",name:"tahun",value:u.tahun,onChange:o,className:"w-[150px]",children:[e.jsx("option",{value:"",children:"Semua Tahun"}),he().map(a=>e.jsx("option",{value:a,children:a},a))]})}),e.jsx(ie,{onHandleFilter:o})]})]}),e.jsxs(G,{children:[e.jsxs(n,{children:[e.jsx(n.Thead,{children:e.jsxs(n.TrHead,{children:[e.jsx(n.Th,{width:"4",ordered:!0,onHandleOrder:d,column:"id",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"no"}),e.jsx(n.Th,{width:"15",children:"Pemegang Anggaran"}),e.jsx(n.Th,{width:"15",ordered:!0,onHandleOrder:d,column:"kategori_id",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"Kategori"}),e.jsx(n.Th,{width:"15",children:"Judul"}),e.jsx(n.Th,{width:"10",ordered:!0,onHandleOrder:d,column:"nominal",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"nominal"}),e.jsx(n.Th,{width:"10",ordered:!0,onHandleOrder:d,column:"bulan",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"bulan"}),e.jsx(n.Th,{width:"7",ordered:!0,onHandleOrder:d,column:"tahun",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"tahun"}),e.jsx(n.Th,{width:"7",ordered:!0,onHandleOrder:d,column:"tipe",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"tipe"}),e.jsx(n.Th,{width:"7",ordered:!0,onHandleOrder:d,column:"status",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"status"}),e.jsx(n.Th,{align:"end",width:"10",children:e.jsx("span",{className:"me-3",children:"opsi"})})]})}),e.jsx(n.Tbody,{children:T()})]}),e.jsx(G.Footer,{data:l,params:r,setParams:P,setFetching:A,onChange:o})]})]}),e.jsx(ue,{title:i,showModal:D,closeModal:I,mode:F,data:m,categories:t,users:j,handleChange:f,errors:v,submit:g,update:E,processing:p}),e.jsx(xe,{title:i,showModal:z,closeModal:R,data:C}),e.jsx(je,{title:i,showModal:W,closeModal:K,data:C,formData:m,handleChange:f,errors:v,submit:S,processing:p})]})};export{We as default};
