import{j as e,y as q,W as V,r as j,q as X,Y as Z}from"./app-B_92siTH.js";import{U as ee,C as ae,B as ne,a as re,b as se,F as oe,D as O,T as n,A as y,c as te}from"./ContentWrapper-CPj8dV98.js";import{c as J}from"./clsx-B-dksMZM.js";import{I as B}from"./Button-BfHHMwRX.js";import{L as $}from"./Label-9HOe2Atq.js";import{N as le}from"./NameWithAvatar-Bm4x1eME.js";import{B as Y}from"./react-toastify.esm-Y3kEwutC.js";import{A as ie}from"./AppContentLayout-RrKymXQ_.js";import{l as de,a as ce,f as he,m as ue,h as me}from"./GlobalFunction-6FUJEloP.js";import pe from"./PerencanaanCreate-BDK6jX9d.js";import xe from"./PerencanaanDetail-DTv71qj0.js";import je from"./PerencanaanConfirm-h9RZSzc4.js";import"./FormInput-DBiJauWZ.js";import"./RegularSubmitModal-CHkNkSu9.js";/* empty css                      */import"./transition-BNoqmgBa.js";import"./FormTextarea-q5WRCSfw.js";import"./Modal-BQ5aMmcz.js";import"./dialog-BaJksHqc.js";const k=({type:o="text",size:i="md",isError:t=!1,className:l,children:r,prefix:m=null,suffix:u=null,...x})=>{let d;return i==="md"?d="h-[45px]":i==="sm"?d="h-[38px] pt-2":d="h-[55px]",e.jsxs("div",{className:"relative border flex items-center rounded-lg w-full",children:[m&&e.jsx("div",{className:J("border-r flex items-center justify-center px-3 overflow-hidden","pb-2",d),children:m}),e.jsx("select",{type:o,className:J(l,d,t?"border-red-700":null,"rounded-lg border-none border-gray-200 focus:border-primary outline-1 focus:outline-none text-sm",m?"pl-3 rounded-e-lg":u?"pe-3 rounded-s-lg":"rounded-lg"),...x,children:r})]})},fe=(o,i,t)=>{q.post(route("perencanaan.store"),o,{onError:l=>{i(l)},onSuccess:()=>{t()},preserveScroll:!1,preserveState:!0})},ge=(o,i,t)=>{q.post(route("perencanaan.update",{perencanaan:o.id}),{...o,_method:"PUT"},{onError:l=>{i(l)},onSuccess:()=>{t()},preserveScroll:!1,preserveState:!0})},ve=(o,i,t)=>{q.post(route("perencanaan.confirm",{perencanaan:o.id}),{...o,_method:"PUT"},{onError:l=>{i(l)},onSuccess:()=>{t()},preserveScroll:!1,preserveState:!0})},De=(o,i)=>{const{data:t,setData:l,reset:r}=V({kategori_id:"",judul:"",nominal:"",bulan:"",tahun:"",tipe:"cash",deskripsi:""}),[m,u]=j.useState({}),[x,d]=j.useState(null),f=()=>{u({})},{mode:N,params:g,setParams:v,fetching:b,request:E,showModal:P,handleShowModal:F,handleEditModal:p,handleCloseModal:h,initialData:c,setInitialData:D,setFetching:_,onHandleFilter:w,onHandleOrder:A}=ee(o,f,r,"perencanaan.index");j.useEffect(()=>{b&&E(g)},[g,b]),j.useEffect(()=>{c.id&&l({id:c.id,kategori_id:c.kategori_id,judul:c.judul,nominal:c.nominal,bulan:c.bulan,tahun:c.tahun,tipe:c.tipe,deskripsi:c.deskripsi})},[c]);const H=s=>{l(s.target.name,s.target.type==="file"?s.target.files[0]:s.target.value)},U=s=>{s.target.checked?l(s.target.name,1):l(s.target.name,0)},I=s=>{s.preventDefault(),d(Y.loading("Sedang menyimpan data...")),fe(t,u,f)},R=s=>{s.preventDefault(),d(Y.loading("Sedang menyimpan data...")),ge(t,u,f)},[W,C]=j.useState({}),[K,S]=j.useState(!1),L=s=>{S(!0),C(s)},a=s=>{S(!1),D({}),r()},[T,M]=j.useState(!1),G=s=>{M(!0),C(s),D(s)},z=s=>{M(!1),D({}),r()},Q=s=>{s.preventDefault(),d(Y.loading("Sedang memproses data...")),ve(t,u,f)};return ae(i,m,x,d,T?z:h),{data:t,processing:x,errors:m,submit:I,update:R,handleChange:H,handleCheckboxChange:U,mode:N,params:g,setParams:v,setFetching:_,onHandleFilter:w,onHandleOrder:A,showModal:P,handleShowModal:F,handleEditModal:p,handleCloseModal:h,detailData:W,showDetailModal:K,handleShowDetailModal:L,handleCloseDetailModal:a,showConfirmModal:T,handleShowConfirmModal:G,handleCloseConfirmModal:z,confirm:Q}},We=({title:o,breadcrumbs:i,datas:t,categories:l,filtered:r,flash:m})=>{const{data:u,processing:x,errors:d,submit:f,update:N,handleChange:g,params:v,setParams:b,setFetching:E,mode:P,showModal:F,onHandleFilter:p,onHandleOrder:h,handleShowModal:c,handleEditModal:D,handleCloseModal:_,detailData:w,showDetailModal:A,handleShowDetailModal:H,handleCloseDetailModal:U,showConfirmModal:I,handleShowConfirmModal:R,handleCloseConfirmModal:W,confirm:C}=De(r,m),{auth:K}=X().props,S=[{value:"waiting",label:"Waiting"},{value:1,label:"Accept"},{value:0,label:"Reject"}],L=()=>t.data.length>0?t.data.map((a,T)=>e.jsxs(n.TrBody,{children:[e.jsx(n.Td,{children:T+1}),e.jsx(n.Td,{children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(le,{avatar:a.user.foto?`/images/${a.user.foto}`:a.user.foto,name:a.user.name})})}),e.jsx(n.Td,{children:a.kategori.nama}),e.jsx(n.Td,{children:a.judul}),e.jsx(n.Td,{children:he(a.nominal)}),e.jsx(n.Td,{children:ue(a.bulan)}),e.jsx(n.Td,{children:a.tahun}),e.jsx(n.Td,{children:e.jsx($,{variant:a.tipe=="cash"?"info":"success",children:a.tipe})}),e.jsx(n.Td,{children:e.jsx($,{variant:a.status==0?"danger":a.status==1?"success":"warning",children:a.status==0?"reject":a.status==1?"accept":"waiting"})}),e.jsxs(n.Td,{className:"text-end pe-3",children:[K.user.roles.find(M=>M.name==="Admin")&&a.status==null?e.jsx(y,{variant:"success",icon:"check-lg",label:"Konfirmasi",onClick:()=>R(a)}):e.jsx(y,{variant:"warning",icon:"search",label:"Detail",onClick:()=>H(a)}),e.jsx(y,{variant:"info",icon:"pencil",label:"Edit",onClick:()=>D(a)}),e.jsx(y,{variant:"danger",icon:"trash",label:"Hapus",onClick:()=>me("perencanaan.destroy",a.id,"Data berhasil dihapus")})]})]},a.id)):e.jsx(te,{colSpan:10});return e.jsxs(ie,{children:[e.jsx(Z,{title:o}),e.jsx(ne,{title:o,breadcrumbs:i}),e.jsxs(re,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[e.jsx(se,{onClick:c}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("div",{children:e.jsxs(k,{prefix:e.jsx(B,{icon:"tag"}),size:"sm",name:"kategori_id",value:v.kategori_id,onChange:p,className:"w-[205px]",children:[e.jsx("option",{value:"",children:"Semua Kategori"}),l.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{children:e.jsxs(k,{prefix:e.jsx(B,{icon:"info-circle"}),size:"sm",name:"status",value:v.status,onChange:p,className:"w-[150px]",children:[e.jsx("option",{value:"",children:"Semua Status"}),S.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{children:e.jsxs(k,{prefix:e.jsx(B,{icon:"calendar-month"}),size:"sm",name:"bulan",value:v.bulan,onChange:p,className:"w-[150px]",children:[e.jsx("option",{value:"",children:"Semua Bulan"}),de().map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{children:e.jsxs(k,{prefix:e.jsx(B,{icon:"calendar-check"}),size:"sm",name:"tahun",value:v.tahun,onChange:p,className:"w-[150px]",children:[e.jsx("option",{value:"",children:"Semua Tahun"}),ce().map(a=>e.jsx("option",{value:a,children:a},a))]})}),e.jsx(oe,{onHandleFilter:p})]})]}),e.jsxs(O,{children:[e.jsxs(n,{children:[e.jsx(n.Thead,{children:e.jsxs(n.TrHead,{children:[e.jsx(n.Th,{width:"4",ordered:!0,onHandleOrder:h,column:"id",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"no"}),e.jsx(n.Th,{width:"15",children:"Pengaju"}),e.jsx(n.Th,{width:"15",ordered:!0,onHandleOrder:h,column:"kategori_id",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"Kategori"}),e.jsx(n.Th,{width:"15",children:"Judul"}),e.jsx(n.Th,{width:"10",ordered:!0,onHandleOrder:h,column:"nominal",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"nominal"}),e.jsx(n.Th,{width:"10",ordered:!0,onHandleOrder:h,column:"bulan",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"bulan"}),e.jsx(n.Th,{width:"7",ordered:!0,onHandleOrder:h,column:"tahun",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"tahun"}),e.jsx(n.Th,{width:"7",ordered:!0,onHandleOrder:h,column:"tipe",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"tipe"}),e.jsx(n.Th,{width:"7",ordered:!0,onHandleOrder:h,column:"status",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"status"}),e.jsx(n.Th,{align:"end",width:"10",children:e.jsx("span",{className:"me-3",children:"opsi"})})]})}),e.jsx(n.Tbody,{children:L()})]}),e.jsx(O.Footer,{data:t,params:r,setParams:b,setFetching:E,onChange:p})]})]}),e.jsx(pe,{title:o,showModal:F,closeModal:_,mode:P,data:u,categories:l,handleChange:g,errors:d,submit:f,update:N,processing:x}),e.jsx(xe,{title:o,showModal:A,closeModal:U,data:w}),e.jsx(je,{title:o,showModal:I,closeModal:W,data:w,formData:u,handleChange:g,errors:d,submit:C,processing:x})]})};export{We as default};
