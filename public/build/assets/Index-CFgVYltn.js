import{y as $,W as X,r as u,q as Z,j as e,Y as ee,a as ae}from"./app-khPyyK-E.js";import{B as ne,C as b}from"./ContentWrapper-BMR15iZw.js";import{U as re,C as se,a as oe,F as ie,D as G,T as n,A as _,b as le}from"./UsePageController-BmsKZ5kP.js";import{F as v}from"./FormSelectPrefix-DWcSLrHb.js";import{I as D}from"./Button-Dp62ijLc.js";import{L as Q}from"./Label-JhmnwH6K.js";import{N as te}from"./NameWithAvatar-Bjs4SFfm.js";import{B as J}from"./react-toastify.esm-Dv8cz7qT.js";import{A as ce}from"./AppContentLayout-BXGPtaf4.js";import{f as C,l as de,a as he,m as me,h as pe}from"./GlobalFunction-B7s3KAFw.js";import xe from"./PerencanaanCreate-JRAku2y9.js";import ue from"./PerencanaanDetail-Bp_BSEkK.js";import je from"./PerencanaanConfirm-CTJTpB9t.js";import"./clsx-B-dksMZM.js";import"./FormInput-DM7GuzKE.js";import"./RegularSubmitModal-B5MkYYuF.js";/* empty css                      */import"./transition-CyX9F3PE.js";import"./FormTextarea-CtGTBWKs.js";import"./Modal-ptuuVaiO.js";import"./dialog-BJT0psZ1.js";const ge=(i,d,l)=>{$.post(route("perencanaan.store"),i,{onError:t=>{d(t)},onSuccess:()=>{l()},preserveScroll:!1,preserveState:!0})},fe=(i,d,l)=>{$.post(route("perencanaan.update",{perencanaan:i.id}),{...i,_method:"PUT"},{onError:t=>{d(t)},onSuccess:()=>{l()},preserveScroll:!1,preserveState:!0})},be=(i,d,l)=>{$.post(route("perencanaan.confirm",{perencanaan:i.id}),{...i,_method:"PUT"},{onError:t=>{d(t)},onSuccess:()=>{l()},preserveScroll:!1,preserveState:!0})},ve=(i,d)=>{const{data:l,setData:t,reset:j}=X({kategori_id:"",pic_id:"",judul:"",nominal:"",bulan:"",tahun:"",tipe:"cash",deskripsi:""}),[h,r]=u.useState({}),[w,p]=u.useState(null),x=()=>{r({})},{mode:S,params:g,setParams:A,fetching:f,request:m,showModal:E,handleShowModal:P,handleEditModal:F,handleCloseModal:N,initialData:o,setInitialData:c,setFetching:H,onHandleFilter:U,onHandleOrder:z}=re(i,x,j,"perencanaan.index");u.useEffect(()=>{f&&m(g)},[g,f]),u.useEffect(()=>{o.id&&t({id:o.id,kategori_id:o.kategori_id,pic_id:o.pic_id,judul:o.judul,nominal:o.nominal,bulan:o.bulan,tahun:o.tahun,tipe:o.tipe,deskripsi:o.deskripsi})},[o]);const T=s=>{t(s.target.name,s.target.type==="file"?s.target.files[0]:s.target.value)},I=s=>{s.target.checked?t(s.target.name,1):t(s.target.name,0)},L=s=>{s.preventDefault(),p(J.loading("Sedang menyimpan data...")),ge(l,r,x)},R=s=>{s.preventDefault(),p(J.loading("Sedang menyimpan data...")),fe(l,r,x)},[W,M]=u.useState({}),[K,y]=u.useState(!1),q=s=>{y(!0),M(s)},O=s=>{y(!1),c({}),j()},[k,a]=u.useState(!1),Y=s=>{a(!0),M(s),c(s)},B=s=>{a(!1),c({}),j()},V=s=>{s.preventDefault(),p(J.loading("Sedang memproses data...")),be(l,r,x)};return se(d,h,w,p,k?B:N),{data:l,processing:w,errors:h,submit:L,update:R,handleChange:T,handleCheckboxChange:I,mode:S,params:g,setParams:A,setFetching:H,onHandleFilter:U,onHandleOrder:z,showModal:E,handleShowModal:P,handleEditModal:F,handleCloseModal:N,detailData:W,showDetailModal:K,handleShowDetailModal:q,handleCloseDetailModal:O,showConfirmModal:k,handleShowConfirmModal:Y,handleCloseConfirmModal:B,confirm:V}},We=({title:i,breadcrumbs:d,datas:l,categories:t,users:j,widget:h,filtered:r,flash:w})=>{const{data:p,processing:x,errors:S,submit:g,update:A,handleChange:f,params:m,setParams:E,setFetching:P,mode:F,showModal:N,onHandleFilter:o,onHandleOrder:c,handleShowModal:H,handleEditModal:U,handleCloseModal:z,detailData:T,showDetailModal:I,handleShowDetailModal:L,handleCloseDetailModal:R,showConfirmModal:W,handleShowConfirmModal:M,handleCloseConfirmModal:K,confirm:y}=ve(r,w),{auth:q}=Z().props,O=[{value:"waiting",label:"Waiting"},{value:1,label:"Accept"},{value:0,label:"Reject"}],k=()=>l.data.length>0?l.data.map((a,Y)=>e.jsxs(n.TrBody,{children:[e.jsx(n.Td,{children:Y+1}),e.jsx(n.Td,{children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(te,{avatar:a.pic.foto?`/images/${a.pic.foto}`:a.pic.foto,name:a.pic.name})})}),e.jsx(n.Td,{children:a.kategori.nama}),e.jsx(n.Td,{children:a.judul}),e.jsx(n.Td,{children:C(a.nominal)}),e.jsx(n.Td,{children:me(a.bulan)}),e.jsx(n.Td,{children:a.tahun}),e.jsx(n.Td,{children:e.jsx(Q,{variant:a.tipe=="cash"?"info":"success",children:a.tipe})}),e.jsx(n.Td,{children:e.jsx(Q,{variant:a.status==0?"danger":a.status==1?"success":"warning",children:a.status==0?"reject":a.status==1?"accept":"waiting"})}),e.jsxs(n.Td,{className:"text-end pe-3",children:[q.user.roles.find(B=>B.name==="Admin")&&a.status==null?e.jsx(_,{variant:"success",icon:"check-lg",label:"Konfirmasi",onClick:()=>M(a)}):e.jsx(_,{variant:"warning",icon:"search",label:"Detail",onClick:()=>L(a)}),e.jsx(_,{variant:"info",icon:"pencil",label:"Edit",onClick:()=>U(a)}),e.jsx(_,{variant:"danger",icon:"trash",label:"Hapus",onClick:()=>pe("perencanaan.destroy",a.id,"Data berhasil dihapus")})]})]},a.id)):e.jsx(le,{colSpan:10});return e.jsxs(ce,{children:[e.jsx(ee,{title:i}),e.jsx(ne,{title:i,breadcrumbs:d}),e.jsxs("div",{className:"grid grid-cols-4 gap-5 mb-5",children:[e.jsx("div",{className:"col-span-4 lg:col-span-1",children:e.jsxs(b,{className:"flex flex-col gap-2 pb-6 text-danger border border-2 border-danger",children:[e.jsx("span",{className:"text-xl font-semibold",children:"Limit Anggaran"}),e.jsx("span",{className:"text-4xl font-bold",children:C(h.limit_anggaran)})]})}),e.jsx("div",{className:"col-span-4 lg:col-span-1",children:e.jsxs(b,{className:"flex flex-col gap-2 pb-6 text-info border border-2 border-info",children:[e.jsx("span",{className:"text-xl font-semibold",children:"Anggaran Diajukan"}),e.jsx("span",{className:"text-4xl font-bold",children:C(h.total_anggaran)})]})}),e.jsx("div",{className:"col-span-4 lg:col-span-1",children:e.jsxs(b,{className:"flex flex-col gap-2 pb-6 text-success border border-2 border-success",children:[e.jsx("span",{className:"text-xl font-semibold",children:"Anggaran Disetujui"}),e.jsx("span",{className:"text-4xl font-bold",children:C(h.total_anggaran_acc)})]})}),e.jsx("div",{className:"col-span-4 lg:col-span-1",children:e.jsxs(b,{className:"flex flex-col gap-2 pb-6 text-warning border border-2 border-warning",children:[e.jsx("span",{className:"text-xl font-semibold",children:"Selisih Anggaran"}),e.jsx("span",{className:"text-4xl font-bold",children:C(h.selisih_anggaran)})]})})]}),e.jsxs(b,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{onClick:H,disabled:h.limit_anggaran==0}),e.jsx(ae,{href:route("perencanaan.view",m),target:"_blank",rel:"noopener noreferrer",className:"rounded-lg bg-transparent text-primary border border-primary group hover:bg-primary hover:text-white w-[37px] h-[37px] flex justify-center items-center",children:e.jsx("i",{className:"bi bi-file-text"})})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("div",{children:e.jsxs(v,{prefix:e.jsx(D,{icon:"person-check"}),size:"sm",name:"pic_id",value:m.pic_id,onChange:o,className:"w-[218px]",children:[e.jsx("option",{value:"",children:"Semua Pemegang Anggaran"}),j.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})}),e.jsx("div",{children:e.jsxs(v,{prefix:e.jsx(D,{icon:"tag"}),size:"sm",name:"kategori_id",value:m.kategori_id,onChange:o,className:"w-[205px]",children:[e.jsx("option",{value:"",children:"Semua Kategori"}),t.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{children:e.jsxs(v,{prefix:e.jsx(D,{icon:"info-circle"}),size:"sm",name:"status",value:m.status,onChange:o,className:"w-[150px]",children:[e.jsx("option",{value:"",children:"Semua Status"}),O.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{children:e.jsxs(v,{prefix:e.jsx(D,{icon:"calendar-month"}),size:"sm",name:"bulan",value:m.bulan,onChange:o,className:"w-[125px]",children:[e.jsx("option",{value:"",children:"Semua Bulan"}),de().map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{children:e.jsxs(v,{prefix:e.jsx(D,{icon:"calendar-check"}),size:"sm",name:"tahun",value:m.tahun,onChange:o,className:"w-[125px]",children:[e.jsx("option",{value:"",children:"Semua Tahun"}),he().map(a=>e.jsx("option",{value:a,children:a},a))]})}),e.jsx(ie,{onHandleFilter:o})]})]}),e.jsxs(G,{children:[e.jsxs(n,{children:[e.jsx(n.Thead,{children:e.jsxs(n.TrHead,{children:[e.jsx(n.Th,{width:"4",ordered:!0,onHandleOrder:c,column:"id",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"no"}),e.jsx(n.Th,{width:"15",children:"Pemegang Anggaran"}),e.jsx(n.Th,{width:"15",ordered:!0,onHandleOrder:c,column:"kategori_id",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"Kategori"}),e.jsx(n.Th,{width:"15",children:"Judul"}),e.jsx(n.Th,{width:"10",ordered:!0,onHandleOrder:c,column:"nominal",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"nominal"}),e.jsx(n.Th,{width:"10",ordered:!0,onHandleOrder:c,column:"bulan",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"bulan"}),e.jsx(n.Th,{width:"7",ordered:!0,onHandleOrder:c,column:"tahun",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"tahun"}),e.jsx(n.Th,{width:"7",ordered:!0,onHandleOrder:c,column:"tipe",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"tipe"}),e.jsx(n.Th,{width:"7",ordered:!0,onHandleOrder:c,column:"status",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"status"}),e.jsx(n.Th,{align:"end",width:"10",children:e.jsx("span",{className:"me-3",children:"opsi"})})]})}),e.jsx(n.Tbody,{children:k()})]}),e.jsx(G.Footer,{data:l,params:r,setParams:E,setFetching:P,onChange:o})]})]}),e.jsx(xe,{title:i,showModal:N,closeModal:z,mode:F,data:p,categories:t,users:j,handleChange:f,errors:S,submit:g,update:A,processing:x}),e.jsx(ue,{title:i,showModal:I,closeModal:R,data:T}),e.jsx(je,{title:i,showModal:W,closeModal:K,data:T,formData:p,handleChange:f,errors:S,submit:y,processing:x})]})};export{We as default};
