import{y as $,W as X,r as u,q as Z,j as e,Y as ee,a as ae}from"./app-DRe3ZoID.js";import{B as re,C as N}from"./ContentWrapper-qH_HQg54.js";import{U as ne,C as se,a as oe,F as ie,D as G,T as r,A as y,b as le}from"./UsePageController-DehWSrjH.js";import{F as k}from"./FormSelectPrefix-BecGyYfe.js";import{I as B}from"./Button-Bi9co_RV.js";import{L as Q}from"./Label-Ei5UlWVb.js";import{N as te}from"./NameWithAvatar-DYRN5J1h.js";import{B as J}from"./react-toastify.esm-DiP7byAa.js";import{A as de}from"./AppContentLayout-OmASg4Pa.js";import{f as _,l as ce,a as he,m as me,h as pe}from"./GlobalFunction-DGaRtxfk.js";import ue from"./PerencanaanCreate-Bsv3roRo.js";import xe from"./PerencanaanDetail-q7aQt43Z.js";import je from"./PerencanaanConfirm-BYcyLPn4.js";import"./clsx-B-dksMZM.js";import"./FormInput-eUwaTByh.js";import"./RegularSubmitModal-CYR0ZasK.js";/* empty css                      */import"./transition-DKMJMnQ-.js";import"./FormTextarea-jZmTlmTJ.js";import"./Modal-DKMrV-75.js";import"./dialog-DmrMdd6q.js";const ge=(i,c,l)=>{$.post(route("perencanaan.store"),i,{onError:t=>{c(t)},onSuccess:()=>{l()},preserveScroll:!1,preserveState:!0})},fe=(i,c,l)=>{$.post(route("perencanaan.update",{perencanaan:i.id}),{...i,_method:"PUT"},{onError:t=>{c(t)},onSuccess:()=>{l()},preserveScroll:!1,preserveState:!0})},be=(i,c,l)=>{$.post(route("perencanaan.confirm",{perencanaan:i.id}),{...i,_method:"PUT"},{onError:t=>{c(t)},onSuccess:()=>{l()},preserveScroll:!1,preserveState:!0})},ve=(i,c)=>{const{data:l,setData:t,reset:j}=X({kategori_id:"",pic_id:"",judul:"",nominal:"",bulan:"",tahun:"",tipe:"cash",deskripsi:""}),[x,n]=u.useState({}),[b,h]=u.useState(null),m=()=>{n({})},{mode:v,params:g,setParams:E,fetching:f,request:p,showModal:P,handleShowModal:A,handleEditModal:F,handleCloseModal:D,initialData:o,setInitialData:d,setFetching:H,onHandleFilter:U,onHandleOrder:I}=ne(i,m,j,"perencanaan.index");u.useEffect(()=>{f&&p(g)},[g,f]),u.useEffect(()=>{o.id&&t({id:o.id,kategori_id:o.kategori_id,pic_id:o.pic_id,judul:o.judul,nominal:o.nominal,bulan:o.bulan,tahun:o.tahun,tipe:o.tipe,deskripsi:o.deskripsi})},[o]);const C=s=>{t(s.target.name,s.target.type==="file"?s.target.files[0]:s.target.value)},z=s=>{s.target.checked?t(s.target.name,1):t(s.target.name,0)},L=s=>{s.preventDefault(),h(J.loading("Sedang menyimpan data...")),ge(l,n,m)},R=s=>{s.preventDefault(),h(J.loading("Sedang menyimpan data...")),fe(l,n,m)},[W,w]=u.useState({}),[K,S]=u.useState(!1),q=s=>{S(!0),w(s)},O=s=>{S(!1),d({}),j()},[T,a]=u.useState(!1),Y=s=>{a(!0),w(s),d(s)},M=s=>{a(!1),d({}),j()},V=s=>{s.preventDefault(),h(J.loading("Sedang memproses data...")),be(l,n,m)};return se(c,x,b,h,T?M:D),{data:l,processing:b,errors:x,submit:L,update:R,handleChange:C,handleCheckboxChange:z,mode:v,params:g,setParams:E,setFetching:H,onHandleFilter:U,onHandleOrder:I,showModal:P,handleShowModal:A,handleEditModal:F,handleCloseModal:D,detailData:W,showDetailModal:K,handleShowDetailModal:q,handleCloseDetailModal:O,showConfirmModal:T,handleShowConfirmModal:Y,handleCloseConfirmModal:M,confirm:V}},We=({title:i,breadcrumbs:c,datas:l,categories:t,users:j,widget:x,filtered:n,flash:b})=>{const{data:h,processing:m,errors:v,submit:g,update:E,handleChange:f,params:p,setParams:P,setFetching:A,mode:F,showModal:D,onHandleFilter:o,onHandleOrder:d,handleShowModal:H,handleEditModal:U,handleCloseModal:I,detailData:C,showDetailModal:z,handleShowDetailModal:L,handleCloseDetailModal:R,showConfirmModal:W,handleShowConfirmModal:w,handleCloseConfirmModal:K,confirm:S}=ve(n,b),{auth:q}=Z().props,O=[{value:"waiting",label:"Waiting"},{value:1,label:"Accept"},{value:0,label:"Reject"}],T=()=>l.data.length>0?l.data.map((a,Y)=>e.jsxs(r.TrBody,{children:[e.jsx(r.Td,{children:Y+1}),e.jsx(r.Td,{children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(te,{avatar:a.pic.foto?`/images/${a.pic.foto}`:a.pic.foto,name:a.pic.name})})}),e.jsx(r.Td,{children:a.kategori.nama}),e.jsx(r.Td,{children:a.judul}),e.jsx(r.Td,{children:_(a.nominal)}),e.jsx(r.Td,{children:me(a.bulan)}),e.jsx(r.Td,{children:a.tahun}),e.jsx(r.Td,{children:e.jsx(Q,{variant:a.tipe=="cash"?"info":"success",children:a.tipe})}),e.jsx(r.Td,{children:e.jsx(Q,{variant:a.status==0?"danger":a.status==1?"success":"warning",children:a.status==0?"reject":a.status==1?"accept":"waiting"})}),e.jsxs(r.Td,{className:"text-end pe-3",children:[q.user.roles.find(M=>M.name==="Admin")&&a.status==null?e.jsx(y,{variant:"success",icon:"check-lg",label:"Konfirmasi",onClick:()=>w(a)}):e.jsx(y,{variant:"warning",icon:"search",label:"Detail",onClick:()=>L(a)}),e.jsx(y,{variant:"info",icon:"pencil",label:"Edit",onClick:()=>U(a)}),e.jsx(y,{variant:"danger",icon:"trash",label:"Hapus",onClick:()=>pe("perencanaan.destroy",a.id,"Data berhasil dihapus")})]})]},a.id)):e.jsx(le,{colSpan:10});return e.jsxs(de,{children:[e.jsx(ee,{title:i}),e.jsx(re,{title:i,breadcrumbs:c}),e.jsxs("div",{className:"grid grid-cols-3 gap-5 mb-5",children:[e.jsx("div",{className:"col-span-3 lg:col-span-1",children:e.jsxs(N,{className:"flex flex-col gap-2 pb-6 text-danger border border-2 border-danger",children:[e.jsx("span",{className:"text-xl font-semibold",children:"Limit Anggaran"}),e.jsx("span",{className:"text-4xl font-bold",children:_(x.limit_anggaran)})]})}),e.jsx("div",{className:"col-span-3 lg:col-span-1",children:e.jsxs(N,{className:"flex flex-col gap-2 pb-6 text-info border border-2 border-info",children:[e.jsx("span",{className:"text-xl font-semibold",children:"Anggaran Diajukan"}),e.jsx("span",{className:"text-4xl font-bold",children:_(x.total_anggaran)})]})}),e.jsx("div",{className:"col-span-3 lg:col-span-1",children:e.jsxs(N,{className:"flex flex-col gap-2 pb-6 text-success border border-2 border-success",children:[e.jsx("span",{className:"text-xl font-semibold",children:"Anggaran Disetujui"}),e.jsx("span",{className:"text-4xl font-bold",children:_(x.total_anggaran_acc)})]})})]}),e.jsxs(N,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{onClick:H}),e.jsx(ae,{href:route("perencanaan.view",p),target:"_blank",rel:"noopener noreferrer",className:"rounded-lg bg-transparent text-primary border border-primary group hover:bg-primary hover:text-white w-[37px] h-[37px] flex justify-center items-center",children:e.jsx("i",{className:"bi bi-file-text"})})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("div",{children:e.jsxs(k,{prefix:e.jsx(B,{icon:"tag"}),size:"sm",name:"kategori_id",value:p.kategori_id,onChange:o,className:"w-[205px]",children:[e.jsx("option",{value:"",children:"Semua Kategori"}),t.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{children:e.jsxs(k,{prefix:e.jsx(B,{icon:"info-circle"}),size:"sm",name:"status",value:p.status,onChange:o,className:"w-[150px]",children:[e.jsx("option",{value:"",children:"Semua Status"}),O.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{children:e.jsxs(k,{prefix:e.jsx(B,{icon:"calendar-month"}),size:"sm",name:"bulan",value:p.bulan,onChange:o,className:"w-[150px]",children:[e.jsx("option",{value:"",children:"Semua Bulan"}),ce().map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{children:e.jsxs(k,{prefix:e.jsx(B,{icon:"calendar-check"}),size:"sm",name:"tahun",value:p.tahun,onChange:o,className:"w-[150px]",children:[e.jsx("option",{value:"",children:"Semua Tahun"}),he().map(a=>e.jsx("option",{value:a,children:a},a))]})}),e.jsx(ie,{onHandleFilter:o})]})]}),e.jsxs(G,{children:[e.jsxs(r,{children:[e.jsx(r.Thead,{children:e.jsxs(r.TrHead,{children:[e.jsx(r.Th,{width:"4",ordered:!0,onHandleOrder:d,column:"id",orderBy:n.orderBy,orderDirection:n.orderDirection,children:"no"}),e.jsx(r.Th,{width:"15",children:"Pemegang Anggaran"}),e.jsx(r.Th,{width:"15",ordered:!0,onHandleOrder:d,column:"kategori_id",orderBy:n.orderBy,orderDirection:n.orderDirection,children:"Kategori"}),e.jsx(r.Th,{width:"15",children:"Judul"}),e.jsx(r.Th,{width:"10",ordered:!0,onHandleOrder:d,column:"nominal",orderBy:n.orderBy,orderDirection:n.orderDirection,children:"nominal"}),e.jsx(r.Th,{width:"10",ordered:!0,onHandleOrder:d,column:"bulan",orderBy:n.orderBy,orderDirection:n.orderDirection,children:"bulan"}),e.jsx(r.Th,{width:"7",ordered:!0,onHandleOrder:d,column:"tahun",orderBy:n.orderBy,orderDirection:n.orderDirection,children:"tahun"}),e.jsx(r.Th,{width:"7",ordered:!0,onHandleOrder:d,column:"tipe",orderBy:n.orderBy,orderDirection:n.orderDirection,children:"tipe"}),e.jsx(r.Th,{width:"7",ordered:!0,onHandleOrder:d,column:"status",orderBy:n.orderBy,orderDirection:n.orderDirection,children:"status"}),e.jsx(r.Th,{align:"end",width:"10",children:e.jsx("span",{className:"me-3",children:"opsi"})})]})}),e.jsx(r.Tbody,{children:T()})]}),e.jsx(G.Footer,{data:l,params:n,setParams:P,setFetching:A,onChange:o})]})]}),e.jsx(ue,{title:i,showModal:D,closeModal:I,mode:F,data:h,categories:t,users:j,handleChange:f,errors:v,submit:g,update:E,processing:m}),e.jsx(xe,{title:i,showModal:z,closeModal:R,data:C}),e.jsx(je,{title:i,showModal:W,closeModal:K,data:C,formData:h,handleChange:f,errors:v,submit:S,processing:m})]})};export{We as default};
