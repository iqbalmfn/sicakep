import{W as Z,r as l,j as a,Y as aa}from"./app-DMGRZ1vv.js";import{B as ea}from"./Breadcrumbs-DMx6HcvE.js";import{C as sa,a as na,D as Q,T as n,b as ra,F as ta}from"./GlobalHooks-s727Hp8c.js";import{F as oa}from"./FormSelectPrefix-DgzwmEAx.js";import{I as ia}from"./Icon-DYZ-ql5k.js";import{L as V}from"./Label-CTF0j2GK.js";import{N as la}from"./NameWithAvatar-DvY6QX8s.js";import{A as k}from"./ActionButton-C5Lbmd5n.js";import{B as K}from"./react-toastify.esm-BnnonY10.js";import{U as da}from"./UsePageController-7lm-BfYZ.js";import{p as ca,a as ma,u as ha}from"./UtangPiutangServices-Bbu4COJz.js";import{A as pa}from"./AppContentLayout-B8fjnhMx.js";import{C as b}from"./ContentWrapper-B0-bjo5a.js";import{f as v,c as X,h as xa}from"./GlobalFunction-DUKsVrhU.js";import ua from"./PiutangCreate-CMt-D8XV.js";import ga from"./PiutangDetail-COxjW-aA.js";import ja from"./PiutangTransaksi-BDRqSEyb.js";import"./Button-gxpgnNGL.js";import"./clsx-B-dksMZM.js";import"./FormInput-IFTqVKUd.js";import"./RegularSubmitModal-DfnlySxC.js";/* empty css                      */import"./transition-C1WHW2uz.js";import"./FormTextarea-CeZNObZv.js";import"./Modal-Cy_lzkl1.js";import"./dialog-CY1XNGoi.js";const fa=(c,N)=>{const{data:i,setData:t,reset:g}=Z({user_id:"",nama:"",jenis:"transfer",nominal:"",tanggal:"",jatuh_tempo:"",deskripsi:""}),[D,m]=l.useState({}),[r,h]=l.useState(null),d=()=>{m({})},{mode:T,params:p,setParams:w,fetching:y,request:S,showModal:_,handleShowModal:B,handleEditModal:P,handleCloseModal:j,initialData:o,setInitialData:x,setFetching:u,onHandleFilter:E,onHandleOrder:F}=da(c,d,g,"utang-piutang.piutang.index");l.useEffect(()=>{y&&S(p)},[p,y]),l.useEffect(()=>{o.id&&t({id:o.id,user_id:o.user_id,nama:o.nama,tanggal:o.tanggal,jatuh_tempo:o.jatuh_tempo,nominal:o.nominal,deskripsi:o.deskripsi})},[o]);const A=e=>{t(e.target.name,e.target.type==="file"?e.target.files[0]:e.target.value)},H=e=>{e.target.checked?t(e.target.name,1):t(e.target.name,0)},L=e=>{e.preventDefault(),h(K.loading("Sedang menyimpan data...")),ca(i,m,d)},I=e=>{e.preventDefault(),h(K.loading("Sedang menyimpan data...")),ma(i,m,d)},[R,U]=l.useState({}),[W,C]=l.useState(!1),O=e=>{C(!0),U(e)},q=e=>{C(!1),x({}),g()},[z,Y]=l.useState({}),[M,s]=l.useState(!1),$=e=>{s(!0),Y(e),t({user_id:e.user_id,piutang_master_id:e.id,judul:"",tipe:"piutang",jenis:"transfer",nominal:"",jatuh_tempo:"",rekening_id:"",deskripsi:""})},f=e=>{s(!1),x({}),g()},G=e=>{t(e.target.name,e.target.type==="file"?e.target.files[0]:e.target.value)},J=e=>{e.preventDefault(),h(K.loading("Sedang menyimpan data...")),ha(i,m,d)};return sa(N,D,r,h,M?f:j),{data:i,processing:r,errors:D,submit:L,update:I,handleChange:A,handleCheckboxChange:H,mode:T,params:p,setParams:w,setFetching:u,onHandleFilter:E,onHandleOrder:F,showModal:_,handleShowModal:B,handleEditModal:P,handleCloseModal:j,detailData:R,showDetailModal:W,handleShowDetailModal:O,handleCloseDetailModal:q,transaksi:z,showTransaksiModal:M,handleShowTransaksiModal:$,handleCloseTransaksiModal:f,handleChangeTransaksi:G,submitPiutang:J}},Ya=({title:c,breadcrumbs:N,datas:i,widget:t,peminjams:g,users:D,rekenings:m,filtered:r,flash:h})=>{const{data:d,processing:T,errors:p,submit:w,update:y,handleChange:S,params:_,setParams:B,setFetching:P,mode:j,showModal:o,onHandleFilter:x,onHandleOrder:u,handleShowModal:E,handleEditModal:F,handleCloseModal:A,detailData:H,showDetailModal:L,handleShowDetailModal:I,handleCloseDetailModal:R,transaksi:U,showTransaksiModal:W,handleShowTransaksiModal:C,handleCloseTransaksiModal:O,handleChangeTransaksi:q,submitPiutang:z}=fa(r,h),Y=()=>i.data.length>0?i.data.map((s,$)=>{const f=Array.isArray(s.piutang_detail)?s.piutang_detail.reduce((G,J)=>G+J.nominal,0):0;return a.jsxs(n.TrBody,{children:[a.jsx(n.Td,{children:$+1}),a.jsx(n.Td,{children:a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(la,{avatar:s.user.foto?`/images/${s.user.foto}`:s.user.foto,name:s.user.name})})}),a.jsx(n.Td,{children:s.nama}),a.jsx(n.Td,{children:v(s.nominal)}),a.jsx(n.Td,{children:X(s.tanggal)}),a.jsx(n.Td,{children:s.jatuh_tempo?X(s.jatuh_tempo):a.jsx(V,{variant:"info",children:"Tidak Ditentukan"})}),a.jsx(n.Td,{children:a.jsx(V,{variant:s.nominal<=f?"success":"danger",children:s.nominal<=f?"Lunas":"Belum Lunas"})}),a.jsxs(n.Td,{className:"text-end pe-3",children:[a.jsx(k,{variant:"warning",icon:"search",label:"Detail",onClick:()=>I(s)}),a.jsx(k,{variant:"success",icon:"currency-dollar",label:"Bayar",onClick:()=>C(s)}),a.jsx(k,{variant:"info",icon:"pencil",label:"Edit",onClick:()=>F(s)}),a.jsx(k,{variant:"danger",icon:"trash",label:"Hapus",onClick:()=>xa("utang-piutang.piutang.destroy",s.id,"Data berhasil dihapus")})]})]},s.id)}):a.jsx(ra,{colSpan:8}),M=()=>a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("div",{children:a.jsxs(oa,{prefix:a.jsx(ia,{icon:"person"}),size:"sm",name:"nama",value:_.nama,onChange:x,className:"w-[205px]",children:[a.jsx("option",{value:"",children:"Semua Peminjam"}),g.map(s=>a.jsx("option",{value:s.nama,children:s.nama},s.id))]})}),a.jsx(ta,{onHandleFilter:x})]});return a.jsxs(pa,{children:[a.jsx(aa,{title:c}),a.jsx(ea,{title:c,breadcrumbs:N}),a.jsxs("div",{className:"grid grid-cols-4 gap-5 mb-5",children:[a.jsx("div",{className:"col-span-4 lg:col-span-1",children:a.jsxs(b,{className:"flex flex-col gap-2 pb-6 text-danger border border-2 border-danger",children:[a.jsx("span",{className:"text-xl font-semibold",children:"Total Piutang"}),a.jsx("span",{className:"text-4xl font-bold",children:v(t.total_piutang)})]})}),a.jsx("div",{className:"col-span-4 lg:col-span-1",children:a.jsxs(b,{className:"flex flex-col gap-2 pb-6 text-success border border-2 border-success",children:[a.jsx("span",{className:"text-xl font-semibold",children:"Sudah Dibayar"}),a.jsx("span",{className:"text-4xl font-bold",children:v(t.total_dibayar)})]})}),a.jsx("div",{className:"col-span-4 lg:col-span-1",children:a.jsxs(b,{className:"flex flex-col gap-2 pb-6 text-danger border border-2 border-danger",children:[a.jsx("span",{className:"text-xl font-semibold",children:"Belum Dibayar"}),a.jsx("span",{className:"text-4xl font-bold",children:v(t.total_belum_dibayar)})]})}),a.jsx("div",{className:"col-span-4 lg:col-span-1",children:a.jsxs(b,{className:"flex flex-col gap-2 pb-6 text-info border border-2 border-info",children:[a.jsx("span",{className:"text-xl font-semibold",children:"Persentase Lunas"}),a.jsxs("span",{className:"text-4xl font-bold",children:[t.persentase,"%"]})]})})]}),a.jsxs(b,{children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(na,{onClick:E})}),M()]}),a.jsxs(Q,{children:[a.jsxs(n,{children:[a.jsx(n.Thead,{children:a.jsxs(n.TrHead,{children:[a.jsx(n.Th,{width:"4",ordered:!0,onHandleOrder:u,column:"id",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"no"}),a.jsx(n.Th,{width:"15",children:"Donatur"}),a.jsx(n.Th,{width:"15",children:"Peminjam"}),a.jsx(n.Th,{width:"10",ordered:!0,onHandleOrder:u,column:"nominal",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"nominal"}),a.jsx(n.Th,{width:"10",ordered:!0,onHandleOrder:u,column:"tanggal",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"tanggal meminjam"}),a.jsx(n.Th,{width:"10",ordered:!0,onHandleOrder:u,column:"jatuh_tempo",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"janji bayar"}),a.jsx(n.Th,{width:"7",children:"status"}),a.jsx(n.Th,{align:"end",width:"10",children:a.jsx("span",{className:"me-3",children:"opsi"})})]})}),a.jsx(n.Tbody,{children:Y()})]}),a.jsx(Q.Footer,{data:i,params:r,setParams:B,setFetching:P,onChange:x})]})]}),a.jsx(ua,{title:c,showModal:o,closeModal:A,mode:j,data:d,users:D,handleChange:S,errors:p,submit:w,update:y,processing:T}),a.jsx(ja,{showModal:W,closeModal:O,mode:j,data:d,rekenings:m,dataTransaksi:U,handleChange:q,errors:p,submit:z,processing:T}),a.jsx(ga,{title:c,showModal:L,closeModal:R,data:H})]})};export{Ya as default};
