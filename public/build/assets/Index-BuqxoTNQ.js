import{y as Y,W as q,r as u,j as e,Y as J,a as $}from"./app-_NiJ0xo3.js";import{B as G}from"./Breadcrumbs-DYRVh2er.js";import{C as Q,a as V,F as X,D as W,T as Z}from"./GlobalHooks-CV5aZBgP.js";import{F as w}from"./FormSelectPrefix-Ct49Tuyl.js";import{I as C}from"./Icon-MuIOKNPg.js";import{L as ee}from"./Label-DXYUMNKH.js";import{N as ae}from"./NameWithAvatar-Diz11eJy.js";import{A as R}from"./ActionButton-e1D8THlH.js";import{U as se,T as s}from"./UsePageController-it4hRsls.js";import{B as L}from"./react-toastify.esm-DGSRAxHI.js";import{A as re}from"./AppContentLayout-BGvSoJ-l.js";import{C as b}from"./ContentWrapper-C_Az5fw-.js";import{f as v,g as ne,l as le,a as oe,b as te,c as ie,h as de}from"./GlobalFunction-DjKt635_.js";import ce from"./PemasukanCreate-DNbfOzYC.js";import me from"./PemasukanDetail-CPtq9c3_.js";import"./Button-BxXJAObj.js";import"./clsx-B-dksMZM.js";import"./FormInput-BC6jvV9W.js";import"./RegularSubmitModal-CHoPSS_q.js";/* empty css                      */import"./transition-6ASALFO_.js";import"./FormTextarea-BngkHt7F.js";import"./Modal-CnPCwk5b.js";import"./dialog-DGDdcYXg.js";const xe=(o,m,t)=>{Y.post(route("transaksi.pemasukan.store"),o,{onError:i=>{m(i)},onSuccess:()=>{t()},preserveScroll:!1,preserveState:!0})},he=(o,m,t)=>{Y.post(route("transaksi.pemasukan.update",{pemasukan:o.id}),{...o,_method:"PUT"},{onError:i=>{m(i)},onSuccess:()=>{t()},preserveScroll:!1,preserveState:!0})},pe=(o,m)=>{const{data:t,setData:i,reset:k}=q({kategori_id:"",user_id:"",rekening_id:"",judul:"",nominal:"",tanggal:"",jenis:"online",deskripsi:""}),[x,p]=u.useState({}),[r,j]=u.useState(null),g=()=>{p({})},{mode:S,params:f,setParams:y,fetching:D,request:_,showModal:d,handleShowModal:M,handleEditModal:B,handleCloseModal:N,initialData:l,setInitialData:c,setFetching:h,onHandleFilter:E,onHandleOrder:P}=se(o,g,k,"transaksi.pemasukan.index");u.useEffect(()=>{D&&_(f)},[f,D]),u.useEffect(()=>{l.id&&i({id:l.id,user_id:l.user_id,kategori_id:l.kategori_id,rekening_id:l.rekening_id,judul:l.judul,nominal:l.nominal,tanggal:l.tanggal,jenis:l.jenis,deskripsi:l.deskripsi})},[l]);const F=n=>{i(n.target.name,n.target.type==="file"?n.target.files[0]:n.target.value)},A=n=>{n.target.checked?i(n.target.name,1):i(n.target.name,0)},H=n=>{n.preventDefault(),j(L.loading("Sedang menyimpan data...")),xe(t,p,g)},U=n=>{n.preventDefault(),j(L.loading("Sedang menyimpan data...")),he(t,p,g)},[z,I]=u.useState({}),[a,T]=u.useState(!1),K=n=>{T(!0),I(n)},O=n=>{T(!1),c({}),k()};return Q(m,x,r,j,N),{data:t,processing:r,errors:x,submit:H,update:U,handleChange:F,handleCheckboxChange:A,mode:S,params:f,setParams:y,setFetching:h,onHandleFilter:E,onHandleOrder:P,showModal:d,handleShowModal:M,handleEditModal:B,handleCloseModal:N,detailData:z,showDetailModal:a,handleShowDetailModal:K,handleCloseDetailModal:O}},Ie=({title:o,breadcrumbs:m,datas:t,categories:i,users:k,widget:x,rekenings:p,filtered:r,flash:j})=>{const{data:g,processing:S,errors:f,submit:y,update:D,handleChange:_,params:d,setParams:M,setFetching:B,mode:N,showModal:l,onHandleFilter:c,onHandleOrder:h,handleShowModal:E,handleEditModal:P,handleCloseModal:F,detailData:A,showDetailModal:H,handleShowDetailModal:U,handleCloseDetailModal:z}=pe(r,j),I=()=>t.data.length>0?t.data.map((a,T)=>e.jsxs(s.TrBody,{children:[e.jsx(s.Td,{children:T+1}),e.jsx(s.Td,{children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ae,{avatar:a.user.foto?`/images/${a.user.foto}`:a.user.foto,name:a.user.name})})}),e.jsx(s.Td,{children:a.kategori.nama}),e.jsx(s.Td,{children:a.judul}),e.jsx(s.Td,{children:v(a.nominal)}),e.jsx(s.Td,{children:ie(a.tanggal)}),e.jsx(s.Td,{children:e.jsx(ee,{variant:a.jenis=="cash"?"info":"success",children:a.jenis})}),e.jsxs(s.Td,{className:"text-end pe-3",children:[e.jsx(R,{variant:"warning",icon:"search",label:"Detail",onClick:()=>U(a)}),e.jsx(R,{variant:"info",icon:"pencil",label:"Edit",onClick:()=>P(a)}),e.jsx(R,{variant:"danger",icon:"trash",label:"Hapus",onClick:()=>de("transaksi.pemasukan.destroy",a.id,"Data berhasil dihapus")})]})]},a.id)):e.jsx(Z,{colSpan:9});return e.jsxs(re,{children:[e.jsx(J,{title:o}),e.jsx(G,{title:o,breadcrumbs:m}),e.jsxs("div",{className:"grid grid-cols-4 gap-5 mb-5",children:[e.jsx("div",{className:"col-span-2 lg:col-span-1",children:e.jsxs(b,{className:"flex flex-col gap-2 pb-6 text-info border border-2 border-info",children:[e.jsx("span",{className:"text-md lg:text-xl font-semibold",children:"Total Pemasukan"}),e.jsx("span",{className:"text-2xl lg:text-4xl font-bold",children:v(x.total_pemasukan)})]})}),e.jsx("div",{className:"col-span-2 lg:col-span-1",children:e.jsxs(b,{className:"flex flex-col gap-2 pb-6 text-warning border border-2 border-warning",children:[e.jsx("span",{className:"text-md lg:text-xl font-semibold",children:"Total Anggaran"}),e.jsx("span",{className:"text-2xl lg:text-4xl font-bold",children:v(x.total_anggaran)})]})}),e.jsx("div",{className:"col-span-2 lg:col-span-1",children:e.jsxs(b,{className:"flex flex-col gap-2 pb-6 text-danger border border-2 border-danger",children:[e.jsx("span",{className:"text-md lg:text-xl font-semibold",children:"Total Pengeluaran"}),e.jsx("span",{className:"text-2xl lg:text-4xl font-bold",children:v(x.total_pengeluaran)})]})}),e.jsx("div",{className:"col-span-2 lg:col-span-1",children:e.jsxs(b,{className:"flex flex-col gap-2 pb-6 text-success border border-2 border-success",children:[e.jsx("span",{className:"text-md lg:text-xl font-semibold",children:"Dana Tersedia"}),e.jsx("span",{className:"text-2xl lg:text-4xl font-bold",children:v(x.dana_tersedia)})]})})]}),e.jsxs(b,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{onClick:E}),e.jsx($,{href:route("perencanaan.view",d),target:"_blank",rel:"noopener noreferrer",className:"rounded-lg bg-transparent text-primary border border-primary group hover:bg-primary hover:text-white w-[37px] h-[37px] flex justify-center items-center",children:e.jsx("i",{className:"bi bi-file-text"})})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("div",{className:"hidden sm:block",children:e.jsxs(w,{prefix:e.jsx(C,{icon:"wallet2"}),size:"sm",name:"rekening_id",value:d.rekening_id,onChange:c,className:"w-[205px]",children:[e.jsx("option",{value:"",children:"Semua Rekening"}),p.map(a=>e.jsx("option",{value:a.id,children:a.nama_rekening},a.id))]})}),e.jsx("div",{className:"hidden sm:block",children:e.jsxs(w,{prefix:e.jsx(C,{icon:"tag"}),size:"sm",name:"kategori_id",value:d.kategori_id,onChange:c,className:"w-[205px]",children:[e.jsx("option",{value:"",children:"Semua Kategori"}),i.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{children:e.jsxs(w,{prefix:e.jsx(C,{icon:"calendar-month"}),size:"sm",name:"bulan",value:d.bulan?d.bulan:ne(),onChange:c,className:"w-[150px]",children:[e.jsx("option",{value:"all",children:"Semua Bulan"}),le().map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})}),e.jsx("div",{className:"hidden sm:block",children:e.jsxs(w,{prefix:e.jsx(C,{icon:"calendar-check"}),size:"sm",name:"tahun",value:d.tahun?d.tahun:oe(),onChange:c,className:"w-[150px]",children:[e.jsx("option",{value:"all",children:"Semua Tahun"}),te().map(a=>e.jsx("option",{value:a,children:a},a))]})}),e.jsx(X,{onHandleFilter:c})]})]}),e.jsxs(W,{children:[e.jsxs(s,{children:[e.jsx(s.Thead,{children:e.jsxs(s.TrHead,{children:[e.jsx(s.Th,{width:"4",ordered:!0,onHandleOrder:h,column:"id",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"no"}),e.jsx(s.Th,{width:"15",children:"Donatur"}),e.jsx(s.Th,{width:"15",ordered:!0,onHandleOrder:h,column:"kategori_id",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"Kategori"}),e.jsx(s.Th,{width:"15",children:"Judul"}),e.jsx(s.Th,{width:"10",ordered:!0,onHandleOrder:h,column:"nominal",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"nominal"}),e.jsx(s.Th,{width:"10",ordered:!0,onHandleOrder:h,column:"tanggal",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"tanggal"}),e.jsx(s.Th,{width:"7",ordered:!0,onHandleOrder:h,column:"jenis",orderBy:r.orderBy,orderDirection:r.orderDirection,children:"jenis"}),e.jsx(s.Th,{align:"end",width:"10",children:e.jsx("span",{className:"me-3",children:"opsi"})})]})}),e.jsx(s.Tbody,{children:I()})]}),e.jsx(W.Footer,{data:t,params:r,setParams:M,setFetching:B,onChange:c})]})]}),e.jsx(ce,{title:o,showModal:l,closeModal:F,mode:N,data:g,categories:i,users:k,rekenings:p,handleChange:_,errors:f,submit:y,update:D,processing:S}),e.jsx(me,{title:o,showModal:H,closeModal:z,data:A})]})};export{Ie as default};
